/*
 * jsTree 1.0-rc3
 * http://jstree.com/
 *
 * Copyright (c) 2010 Ivan Bozhanov (vakata.com)
 *
 * Licensed same as jquery - under the terms of either the MIT License or the GPL Version 2 License
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * $Date: 2011-02-09 01:17:14 +0200 $
 * $Revision: 236 $
 *
 * Removed dependency on $.fn.andSelf()
 * Copyright (c) 2013 Christoph M. Becker <http://3-magi.net/>
 */
"use strict",function(){function d(a){return $.fn.addBack?a.addBack():a.andSelf()}if(jQuery&&jQuery.jstree)return;var a=!1,b=!1,c=!1;(function(e){e.vakata={},e.vakata.css={get_css:function(a,b,c){a=a.toLowerCase();var d=c.cssRules||c.rules,e=0;do{if(d.length&&e>d.length+5)return!1;if(d[e].selectorText&&d[e].selectorText.toLowerCase()==a)return b===!0?(c.removeRule&&c.removeRule(e),c.deleteRule&&c.deleteRule(e),!0):d[e]}while(d[++e]);return!1},add_css:function(a,b){return e.jstree.css.get_css(a,!1,b)?!1:(b.insertRule?b.insertRule(a+" { }",0):b.addRule(a,null,0),e.vakata.css.get_css(a))},remove_css:function(a,b){return e.vakata.css.get_css(a,!0,b)},add_sheet:function(a){var b=!1,c=!0;if(a.str)return a.title&&(b=e("style[id='"+a.title+"-stylesheet']")[0]),b?c=!1:(b=document.createElement("style"),b.setAttribute("type","text/css"),a.title&&b.setAttribute("id",a.title+"-stylesheet")),b.styleSheet?c?(document.getElementsByTagName("head")[0].appendChild(b),b.styleSheet.cssText=a.str):b.styleSheet.cssText=b.styleSheet.cssText+" "+a.str:(b.appendChild(document.createTextNode(a.str)),document.getElementsByTagName("head")[0].appendChild(b)),b.sheet||b.styleSheet;if(a.url){if(!document.createStyleSheet)return b=document.createElement("link"),b.rel="stylesheet",b.type="text/css",b.media="all",b.href=a.url,document.getElementsByTagName("head")[0].appendChild(b),b.styleSheet;try{b=document.createStyleSheet(a.url)}catch(d){}}}};var f=[],g=-1,h={},i={};e.fn.jstree=function(a){var b=typeof a=="string",c=Array.prototype.slice.call(arguments,1),d=this;if(b){if(a.substring(0,1)=="_")return d;this.each(function(){var b=f[e.data(this,"jstree_instance_id")],g=b&&e.isFunction(b[a])?b[a].apply(b,c):b;if(typeof g!="undefined"&&(a.indexOf("is_")===0||g!==!0&&g!==!1))return d=g,!1})}else this.each(function(){var b=e.data(this,"jstree_instance_id"),d=[],g=a?e.extend({},!0,a):{},i=e(this),j=!1,k=[];d=d.concat(c),i.data("jstree")&&d.push(i.data("jstree")),g=d.length?e.extend.apply(null,[!0,g].concat(d)):g,typeof b!="undefined"&&f[b]&&f[b].destroy(),b=parseInt(f.push({}),10)-1,e.data(this,"jstree_instance_id",b),g.plugins=e.isArray(g.plugins)?g.plugins:e.jstree.defaults.plugins.slice(),g.plugins.unshift("core"),g.plugins=g.plugins.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(","),j=e.extend(!0,{},e.jstree.defaults,g),j.plugins=g.plugins,e.each(h,function(a,b){e.inArray(a,j.plugins)===-1?(j[a]=null,delete j[a]):k.push(a)}),j.plugins=k,f[b]=new e.jstree._instance(b,e(this).addClass("jstree jstree-"+b),j),e.each(f[b]._get_settings().plugins,function(a,c){f[b].data[c]={}}),e.each(f[b]._get_settings().plugins,function(a,c){h[c]&&h[c].__init.apply(f[b])}),setTimeout(function(){f[b]&&f[b].init()},0)});return d},e.jstree={defaults:{plugins:[]},_focused:function(){return f[g]||null},_reference:function(a){if(f[a])return f[a];var b=e(a);return!b.length&&typeof a=="string"&&(b=e("#"+a)),b.length?f[b.closest(".jstree").data("jstree_instance_id")]||null:null},_instance:function(a,b,c){this.data={core:{}},this.get_settings=function(){return e.extend(!0,{},c)},this._get_settings=function(){return c},this.get_index=function(){return a},this.get_container=function(){return b},this.get_container_ul=function(){return b.children("ul:eq(0)")},this._set_settings=function(a){c=e.extend(!0,{},c,a)}},_fn:{},plugin:function(a,b){b=e.extend({},{__init:e.noop,__destroy:e.noop,_fn:{},defaults:!1},b),h[a]=b,e.jstree.defaults[a]=b.defaults,e.each(b._fn,function(b,c){c.plugin=a,c.old=e.jstree._fn[b],e.jstree._fn[b]=function(){var a,d=c,f=Array.prototype.slice.call(arguments),g=new e.Event("before.jstree"),h=!1;if(this.data.core.locked===!0&&b!=="unlock"&&b!=="is_locked")return;do{if(d&&d.plugin&&e.inArray(d.plugin,this._get_settings().plugins)!==-1)break;d=d.old}while(d);if(!d)return;if(b.indexOf("_")===0)a=d.apply(this,f);else{a=this.get_container().triggerHandler(g,{func:b,inst:this,args:f,plugin:d.plugin});if(a===!1)return;typeof a!="undefined"&&(f=a),a=d.apply(e.extend({},this,{__callback:function(a){this.get_container().triggerHandler(b+".jstree",{inst:this,args:f,rslt:a,rlbk:h})},__rollback:function(){return h=this.get_rollback(),h},__call_old:function(a){return d.old.apply(this,a?Array.prototype.slice.call(arguments,1):f)}}),f)}return a},e.jstree._fn[b].old=c.old,e.jstree._fn[b].plugin=a})},rollback:function(a){a&&(e.isArray(a)||(a=[a]),e.each(a,function(a,b){f[b.i].set_rollback(b.h,b.d)}))}},e.jstree._fn=e.jstree._instance.prototype={},e(function(){var d=navigator.userAgent.toLowerCase(),f=(d.match(/.+?(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[0,"0"])[1],g=".jstree ul, .jstree li { display:block; margin:0 0 0 0; padding:0 0 0 0; list-style-type:none; } .jstree li { display:block; min-height:18px; line-height:18px; white-space:nowrap; margin-left:18px; min-width:18px; } .jstree-rtl li { margin-left:0; margin-right:18px; } .jstree > ul > li { margin-left:0px; } .jstree-rtl > ul > li { margin-right:0px; } .jstree ins { display:inline-block; text-decoration:none; width:18px; height:18px; margin:0 0 0 0; padding:0; } .jstree a { display:inline-block; line-height:16px; height:16px; color:black; white-space:nowrap; text-decoration:none; padding:1px 2px; margin:0; } .jstree a:focus { outline: none; } .jstree a > ins { height:16px; width:16px; } .jstree a > .jstree-icon { margin-right:3px; } .jstree-rtl a > .jstree-icon { margin-left:3px; margin-right:0; } li.jstree-open > ul { display:block; } li.jstree-closed > ul { display:none; } ";if(/msie/.test(d)&&parseInt(f,10)==6){a=!0;try{document.execCommand("BackgroundImageCache",!1,!0)}catch(h){}g+=".jstree li { height:18px; margin-left:0; margin-right:0; } .jstree li li { margin-left:18px; } .jstree-rtl li li { margin-left:0px; margin-right:18px; } li.jstree-open ul { display:block; } li.jstree-closed ul { display:none !important; } .jstree li a { display:inline; border-width:0 !important; padding:0px 2px !important; } .jstree li a ins { height:16px; width:16px; margin-right:3px; } .jstree-rtl li a ins { margin-right:0px; margin-left:3px; } "}/msie/.test(d)&&parseInt(f,10)==7&&(b=!0,g+=".jstree li a { border-width:0 !important; padding:0px 2px !important; } "),!/compatible/.test(d)&&/mozilla/.test(d)&&parseFloat(f,10)<1.9&&(c=!0,g+=".jstree ins { display:-moz-inline-box; } .jstree li { line-height:12px; } .jstree a { display:-moz-inline-box; } .jstree .jstree-no-icons .jstree-checkbox { display:-moz-inline-stack !important; } "),e.vakata.css.add_sheet({str:g,title:"jstree"})}),e.jstree.plugin("core",{__init:function(){this.data.core.locked=!1,this.data.core.to_open=this.get_settings().core.initially_open,this.data.core.to_load=this.get_settings().core.initially_load},defaults:{html_titles:!1,animation:500,initially_open:[],initially_load:[],open_parents:!0,notify_plugins:!0,rtl:!1,load_open:!1,strings:{loading:"Loading ...",new_node:"New node",multiple_selection:"Multiple selection"}},_fn:{init:function(){this.set_focus(),this._get_settings().core.rtl&&this.get_container().addClass("jstree-rtl").css("direction","rtl"),this.get_container().html("<ul><li class='jstree-last jstree-leaf'><ins>&#160;</ins><a class='jstree-loading' href='#'><ins class='jstree-icon'>&#160;</ins>"+this._get_string("loading")+"</a></li></ul>"),this.data.core.li_height=this.get_container_ul().find("li.jstree-closed, li.jstree-leaf").eq(0).height()||18,this.get_container().delegate("li > ins","click.jstree",e.proxy(function(a){var b=e(a.target);this.toggle_node(b)},this)).bind("mousedown.jstree",e.proxy(function(){this.set_focus()},this)).bind("dblclick.jstree",function(a){var b;if(document.selection&&document.selection.empty)document.selection.empty();else if(window.getSelection){b=window.getSelection();try{b.removeAllRanges(),b.collapse()}catch(c){}}}),this._get_settings().core.notify_plugins&&this.get_container().bind("load_node.jstree",e.proxy(function(a,b){var c=this._get_node(b.rslt.obj),d=this;c===-1&&(c=this.get_container_ul());if(!c.length)return;c.find("li").each(function(){var a=e(this);a.data("jstree")&&e.each(a.data("jstree"),function(b,c){d.data[b]&&e.isFunction(d["_"+b+"_notify"])&&d["_"+b+"_notify"].call(d,a,c)})})},this)),this._get_settings().core.load_open&&this.get_container().bind("load_node.jstree",e.proxy(function(a,b){var c=this._get_node(b.rslt.obj),d=this;c===-1&&(c=this.get_container_ul());if(!c.length)return;c.find("li.jstree-open:not(:has(ul))").each(function(){d.load_node(this,e.noop,e.noop)})},this)),this.__callback(),this.load_node(-1,function(){this.loaded(),this.reload_nodes()})},destroy:function(){var a,b=this.get_index(),c=this._get_settings(),i=this;e.each(c.plugins,function(a,b){try{h[b].__destroy.apply(i)}catch(c){}}),this.__callback();if(this.is_focused())for(a in f)if(f.hasOwnProperty(a)&&a!=b){f[a].set_focus();break}b===g&&(g=-1),d(this.get_container().unbind(".jstree").undelegate(".jstree").removeData("jstree_instance_id").find("[class^='jstree']")).attr("class",function(){return this.className.replace(/jstree[^ ]*|$/ig,"")}),e(document).unbind(".jstree-"+b).undelegate(".jstree-"+b),f[b]=null,delete f[b]},_core_notify:function(a,b){b.opened&&this.open_node(a,!1,!0)},lock:function(){this.data.core.locked=!0,this.get_container().children("ul").addClass("jstree-locked").css("opacity","0.7"),this.__callback({})},unlock:function(){this.data.core.locked=!1,this.get_container().children("ul").removeClass("jstree-locked").css("opacity","1"),this.__callback({})},is_locked:function(){return this.data.core.locked},save_opened:function(){var a=this;this.data.core.to_open=[],this.get_container_ul().find("li.jstree-open").each(function(){this.id&&a.data.core.to_open.push("#"+this.id.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:"))}),this.__callback(a.data.core.to_open)},save_loaded:function(){},reload_nodes:function(a){var b=this,c=!0,d=[],f=[];a||(this.data.core.reopen=!1,this.data.core.refreshing=!0,this.data.core.to_open=e.map(e.makeArray(this.data.core.to_open),function(a){return"#"+a.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")}),this.data.core.to_load=e.map(e.makeArray(this.data.core.to_load),function(a){return"#"+a.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")}),this.data.core.to_open.length&&(this.data.core.to_load=this.data.core.to_load.concat(this.data.core.to_open))),this.data.core.to_load.length&&(e.each(this.data.core.to_load,function(a,b){if(b=="#")return!0;e(b).length?d.push(b):f.push(b)}),d.length&&(this.data.core.to_load=f,e.each(d,function(a,d){b._is_loaded(d)||(b.load_node(d,function(){b.reload_nodes(!0)},function(){b.reload_nodes(!0)}),c=!1)}))),this.data.core.to_open.length&&e.each(this.data.core.to_open,function(a,c){b.open_node(c,!1,!0)}),c&&(this.data.core.reopen&&clearTimeout(this.data.core.reopen),this.data.core.reopen=setTimeout(function(){b.__callback({},b)},50),this.data.core.refreshing=!1,this.reopen())},reopen:function(){var a=this;this.data.core.to_open.length&&e.each(this.data.core.to_open,function(b,c){a.open_node(c,!1,!0)}),this.__callback({})},refresh:function(a){var b=this;this.save_opened(),a||(a=-1),a=this._get_node(a),a||(a=-1),a!==-1?a.children("UL").remove():this.get_container_ul().empty(),this.load_node(a,function(){b.__callback({obj:a}),b.reload_nodes()})},loaded:function(){this.__callback()},set_focus:function(){if(this.is_focused())return;var a=e.jstree._focused();a&&a.unset_focus(),this.get_container().addClass("jstree-focused"),g=this.get_index(),this.__callback()},is_focused:function(){return g==this.get_index()},unset_focus:function(){this.is_focused()&&(this.get_container().removeClass("jstree-focused"),g=-1),this.__callback()},_get_node:function(a){var b=e(a,this.get_container());return b.is(".jstree")||a==-1?-1:(b=b.closest("li",this.get_container()),b.length?b:!1)},_get_next:function(a,b){return a=this._get_node(a),a===-1?this.get_container().find("> ul > li:first-child"):a.length?b?a.nextAll("li").size()>0?a.nextAll("li:eq(0)"):!1:a.hasClass("jstree-open")?a.find("li:eq(0)"):a.nextAll("li").size()>0?a.nextAll("li:eq(0)"):a.parentsUntil(".jstree","li").next("li").eq(0):!1},_get_prev:function(a,b){a=this._get_node(a);if(a===-1)return this.get_container().find("> ul > li:last-child");if(!a.length)return!1;if(b)return a.prevAll("li").length>0?a.prevAll("li:eq(0)"):!1;if(a.prev("li").length){a=a.prev("li").eq(0);while(a.hasClass("jstree-open"))a=a.children("ul:eq(0)").children("li:last");return a}var c=a.parentsUntil(".jstree","li:eq(0)");return c.length?c:!1},_get_parent:function(a){a=this._get_node(a);if(a==-1||!a.length)return!1;var b=a.parentsUntil(".jstree","li:eq(0)");return b.length?b:-1},_get_children:function(a){return a=this._get_node(a),a===-1?this.get_container().children("ul:eq(0)").children("li"):a.length?a.children("ul:eq(0)").children("li"):!1},get_path:function(a,b){var c=[],d=this;return a=this._get_node(a),a===-1||!a||!a.length?!1:(a.parentsUntil(".jstree","li").each(function(){c.push(b?this.id:d.get_text(this))}),c.reverse(),c.push(b?a.attr("id"):this.get_text(a)),c)},_get_string:function(a){return this._get_settings().core.strings[a]||a},is_open:function(a){return a=this._get_node(a),a&&a!==-1&&a.hasClass("jstree-open")},is_closed:function(a){return a=this._get_node(a),a&&a!==-1&&a.hasClass("jstree-closed")},is_leaf:function(a){return a=this._get_node(a),a&&a!==-1&&a.hasClass("jstree-leaf")},correct_state:function(a){a=this._get_node(a);if(!a||a===-1)return!1;a.removeClass("jstree-closed jstree-open").addClass("jstree-leaf").children("ul").remove(),this.__callback({obj:a})},open_node:function(b,c,d){b=this._get_node(b);if(!b.length)return!1;if(!b.hasClass("jstree-closed"))return c&&c.call(),!1;var e=d||a?0:this._get_settings().core.animation,f=this;this._is_loaded(b)?(this._get_settings().core.open_parents&&b.parentsUntil(".jstree",".jstree-closed").each(function(){f.open_node(this,!1,!0)}),e&&b.children("ul").css("display","none"),b.removeClass("jstree-closed").addClass("jstree-open").children("a").removeClass("jstree-loading"),e?b.children("ul").stop(!0,!0).slideDown(e,function(){this.style.display="",f.after_open(b)}):f.after_open(b),this.__callback({obj:b}),c&&c.call()):(b.children("a").addClass("jstree-loading"),this.load_node(b,function(){f.open_node(b,c,d)},c))},after_open:function(a){this.__callback({obj:a})},close_node:function(b,c){b=this._get_node(b);var d=c||a?0:this._get_settings().core.animation,e=this;if(!b.length||!b.hasClass("jstree-open"))return!1;d&&b.children("ul").attr("style","display:block !important"),b.removeClass("jstree-open").addClass("jstree-closed"),d?b.children("ul").stop(!0,!0).slideUp(d,function(){this.style.display="",e.after_close(b)}):e.after_close(b),this.__callback({obj:b})},after_close:function(a){this.__callback({obj:a})},toggle_node:function(a){a=this._get_node(a);if(a.hasClass("jstree-closed"))return this.open_node(a);if(a.hasClass("jstree-open"))return this.close_node(a)},open_all:function(a,b,c){a=a?this._get_node(a):-1;if(!a||a===-1)a=this.get_container_ul();c?a=a.find("li.jstree-closed"):(c=a,a.is(".jstree-closed")?a=d(a.find("li.jstree-closed")):a=a.find("li.jstree-closed"));var e=this;a.each(function(){var a=this;e._is_loaded(this)?e.open_node(this,!1,!b):e.open_node(this,function(){e.open_all(a,b,c)},!b)}),c.find("li.jstree-closed").length===0&&this.__callback({obj:c})},close_all:function(a,b){var c=this;a=a?this._get_node(a):this.get_container();if(!a||a===-1)a=this.get_container_ul();d(a.find("li.jstree-open")).each(function(){c.close_node(this,!b)}),this.__callback({obj:a})},clean_node:function(a){a=a&&a!=-1?e(a):this.get_container_ul(),a=a.is("li")?d(a.find("li")):a.find("li"),a.removeClass("jstree-last").filter("li:last-child").addClass("jstree-last").end().filter(":has(li)").not(".jstree-open").removeClass("jstree-leaf").addClass("jstree-closed"),a.not(".jstree-open, .jstree-closed").addClass("jstree-leaf").children("ul").remove(),this.__callback({obj:a})},get_rollback:function(){return this.__callback(),{i:this.get_index(),h:this.get_container().children("ul").clone(!0),d:this.data}},set_rollback:function(a,b){this.get_container().empty().append(a),this.data=b,this.__callback()},load_node:function(a,b,c){this.__callback({obj:a})},_is_loaded:function(a){return!0},create_node:function(a,b,c,d,f){a=this._get_node(a),b=typeof b=="undefined"?"last":b;var g=e("<li />"),h=this._get_settings().core,i;if(a!==-1&&!a.length)return!1;if(!f&&!this._is_loaded(a))return this.load_node(a,function(){this.create_node(a,b,c,d,!0)}),!1;this.__rollback(),typeof c=="string"&&(c={data:c}),c||(c={}),c.attr&&g.attr(c.attr),c.metadata&&g.data(c.metadata),c.state&&g.addClass("jstree-"+c.state),c.data||(c.data=this._get_string("new_node")),e.isArray(c.data)||(i=c.data,c.data=[],c.data.push(i)),e.each(c.data,function(a,b){i=e("<a />"),e.isFunction(b)&&(b=b.call(this,c)),typeof b=="string"?i.attr("href","#")[h.html_titles?"html":"text"](b):(b.attr||(b.attr={}),b.attr.href||(b.attr.href="#"),i.attr(b.attr)[h.html_titles?"html":"text"](b.title),b.language&&i.addClass(b.language)),i.prepend("<ins class='jstree-icon'>&#160;</ins>"),!b.icon&&c.icon&&(b.icon=c.icon),b.icon&&(b.icon.indexOf("/")===-1?i.children("ins").addClass(b.icon):i.children("ins").css("background","url('"+b.icon+"') center center no-repeat")),g.append(i)}),g.prepend("<ins class='jstree-icon'>&#160;</ins>"),a===-1&&(a=this.get_container(),b==="before"&&(b="first"),b==="after"&&(b="last"));switch(b){case"before":a.before(g),i=this._get_parent(a);break;case"after":a.after(g),i=this._get_parent(a);break;case"inside":case"first":a.children("ul").length||a.append("<ul />"),a.children("ul").prepend(g),i=a;break;case"last":a.children("ul").length||a.append("<ul />"),a.children("ul").append(g),i=a;break;default:a.children("ul").length||a.append("<ul />"),b||(b=0),i=a.children("ul").children("li").eq(b),i.length?i.before(g):a.children("ul").append(g),i=a}if(i===-1||i.get(0)===this.get_container().get(0))i=-1;return this.clean_node(i),this.__callback({obj:g,parent:i}),d&&d.call(this,g),g},get_text:function(a){a=this._get_node(a);if(!a.length)return!1;var b=this._get_settings().core.html_titles;return a=a.children("a:eq(0)"),b?(a=a.clone(),a.children("INS").remove(),a.html()):(a=a.contents().filter(function(){return this.nodeType==3})[0],a.nodeValue)},set_text:function(a,b){a=this._get_node(a);if(!a.length)return!1;a=a.children("a:eq(0)");if(this._get_settings().core.html_titles){var c=a.children("INS").clone();return a.html(b).prepend(c),this.__callback({obj:a,name:b}),!0}return a=a.contents().filter(function(){return this.nodeType==3})[0],this.__callback({obj:a,name:b}),a.nodeValue=b},rename_node:function(a,b){a=this._get_node(a),this.__rollback(),a&&a.length&&this.set_text.apply(this,Array.prototype.slice.call(arguments))&&this.__callback({obj:a,name:b})},delete_node:function(a){a=this._get_node(a);if(!a.length)return!1;this.__rollback();var b=this._get_parent(a),c=e([]),d=this;return a.each(function(){c=c.add(d._get_prev(this))}),a=a.detach(),b!==-1&&b.find("> ul > li").length===0&&b.removeClass("jstree-open jstree-closed").addClass("jstree-leaf"),this.clean_node(b),this.__callback({obj:a,prev:c,parent:b}),a},prepare_move:function(a,b,c,d,f){var g={};g.ot=e.jstree._reference(a)||this,g.o=g.ot._get_node(a),g.r=b===-1?-1:this._get_node(b),g.p=typeof c=="undefined"||c===!1?"last":c;if(!f&&i.o&&i.o[0]===g.o[0]&&i.r[0]===g.r[0]&&i.p===g.p){this.__callback(i),d&&d.call(this,i);return}g.ot=e.jstree._reference(g.o)||this,g.rt=e.jstree._reference(g.r)||this;if(g.r===-1||!g.r){g.cr=-1;switch(g.p){case"first":case"before":case"inside":g.cp=0;break;case"after":case"last":g.cp=g.rt.get_container().find(" > ul > li").length;break;default:g.cp=g.p}}else{if(!/^(before|after)$/.test(g.p)&&!this._is_loaded(g.r))return this.load_node(g.r,function(){this.prepare_move(a,b,c,d,!0)});switch(g.p){case"before":g.cp=g.r.index(),g.cr=g.rt._get_parent(g.r);break;case"after":g.cp=g.r.index()+1,g.cr=g.rt._get_parent(g.r);break;case"inside":case"first":g.cp=0,g.cr=g.r;break;case"last":g.cp=g.r.find(" > ul > li").length,g.cr=g.r;break;default:g.cp=g.p,g.cr=g.r}}g.np=g.cr==-1?g.rt.get_container():g.cr,g.op=g.ot._get_parent(g.o),g.cop=g.o.index(),g.op===-1&&(g.op=g.ot?g.ot.get_container():this.get_container()),!/^(before|after)$/.test(g.p)&&g.op&&g.np&&g.op[0]===g.np[0]&&g.o.index()<g.cp&&g.cp++,g.or=g.np.find(" > ul > li:nth-child("+(g.cp+1)+")"),i=g,this.__callback(i),d&&d.call(this,i)},check_move:function(){var a=i,b=!0,c=a.r===-1?this.get_container():a.r;if(!a||!a.o||a.or[0]===a.o[0])return!1;if(!a.cy){if(a.op&&a.np&&a.op[0]===a.np[0]&&a.cp-1===a.o.index())return!1;a.o.each(function(){if(d(c.parentsUntil(".jstree","li")).index(this)!==-1)return b=!1,!1})}return b},move_node:function(a,b,c,f,g,h){if(!g)return this.prepare_move(a,b,c,function(a){this.move_node(a,!1,!1,f,!0,h)});f&&(i.cy=!0);if(!h&&!this.check_move())return!1;this.__rollback();var j=!1;f?(j=a.o.clone(!0),d(j.find("*[id]")).each(function(){this.id&&(this.id="copy_"+this.id)})):j=a.o,a.or.length?a.or.before(j):(a.np.children("ul").length||e("<ul />").appendTo(a.np),a.np.children("ul:eq(0)").append(j));try{a.ot.clean_node(a.op),a.rt.clean_node(a.np),a.op.find("> ul > li").length||a.op.removeClass("jstree-open jstree-closed").addClass("jstree-leaf").children("ul").remove()}catch(k){}return f&&(i.cy=!0,i.oc=j),this.__callback(i),i},_get_move:function(){return i}}})})(jQuery),function(a){var b,c,e;a(function(){/msie/.test(navigator.userAgent.toLowerCase())?(c=a('<textarea cols="10" rows="2"></textarea>').css({position:"absolute",top:-1e3,left:0}).appendTo("body"),e=a('<textarea cols="10" rows="2" style="overflow: hidden;"></textarea>').css({position:"absolute",top:-1e3,left:0}).appendTo("body"),b=c.width()-e.width(),c.add(e).remove()):(c=a("<div />").css({width:100,height:100,overflow:"auto",position:"absolute",top:-1e3,left:0}).prependTo("body").append("<div />").find("div").css({width:"100%",height:200}),b=100-c.width(),c.parent().remove())}),a.jstree.plugin("ui",{__init:function(){this.data.ui.selected=a(),this.data.ui.last_selected=!1,this.data.ui.hovered=null,this.data.ui.to_select=this.get_settings().ui.initially_select,this.get_container().delegate("a","click.jstree",a.proxy(function(b){b.preventDefault(),b.currentTarget.blur(),a(b.currentTarget).hasClass("jstree-loading")||this.select_node(b.currentTarget,!0,b)},this)).delegate("a","mouseenter.jstree",a.proxy(function(b){a(b.currentTarget).hasClass("jstree-loading")||this.hover_node(b.target)},this)).delegate("a","mouseleave.jstree",a.proxy(function(b){a(b.currentTarget).hasClass("jstree-loading")||this.dehover_node(b.target)},this)).bind("reopen.jstree",a.proxy(function(){this.reselect()},this)).bind("get_rollback.jstree",a.proxy(function(){this.dehover_node(),this.save_selected()},this)).bind("set_rollback.jstree",a.proxy(function(){this.reselect()},this)).bind("close_node.jstree",a.proxy(function(b,c){var d=this._get_settings().ui,e=this._get_node(c.rslt.obj),f=e&&e.length?e.children("ul").find("a.jstree-clicked"):a(),g=this;if(d.selected_parent_close===!1||!f.length)return;f.each(function(){g.deselect_node(this),d.selected_parent_close==="select_parent"&&g.select_node(e)})},this)).bind("delete_node.jstree",a.proxy(function(a,b){var c=this._get_settings().ui.select_prev_on_delete,d=this._get_node(b.rslt.obj),e=d&&d.length?d.find("a.jstree-clicked"):[],f=this;e.each(function(){f.deselect_node(this)}),c&&e.length&&b.rslt.prev.each(function(){if(this.parentNode)return f.select_node(this),!1})},this)).bind("move_node.jstree",a.proxy(function(a,b){b.rslt.cy&&b.rslt.oc.find("a.jstree-clicked").removeClass("jstree-clicked")},this))},defaults:{select_limit:-1,select_multiple_modifier:"ctrl",select_range_modifier:"shift",selected_parent_close:"select_parent",selected_parent_open:!0,select_prev_on_delete:!0,disable_selecting_children:!1,initially_select:[]},_fn:{_get_node:function(b,c){if(typeof b=="undefined"||b===null)return c?this.data.ui.selected:this.data.ui.last_selected;var d=a(b,this.get_container());return d.is(".jstree")||b==-1?-1:(d=d.closest("li",this.get_container()),d.length?d:!1)},_ui_notify:function(a,b){b.selected&&this.select_node(a,!1)},save_selected:function(){var a=this;this.data.ui.to_select=[],this.data.ui.selected.each(function(){this.id&&a.data.ui.to_select.push("#"+this.id.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:"))}),this.__callback(this.data.ui.to_select)},reselect:function(){var b=this,c=this.data.ui.to_select;c=a.map(a.makeArray(c),function(a){return"#"+a.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")}),a.each(c,function(a,c){c&&c!=="#"&&b.select_node(c)}),this.data.ui.selected=this.data.ui.selected.filter(function(){return this.parentNode}),this.__callback()},refresh:function(a){return this.save_selected(),this.__call_old()},hover_node:function(a){a=this._get_node(a);if(!a.length)return!1;a.hasClass("jstree-hovered")||this.dehover_node(),this.data.ui.hovered=a.children("a").addClass("jstree-hovered").parent(),this._fix_scroll(a),this.__callback({obj:a})},dehover_node:function(){var a=this.data.ui.hovered,b;if(!a||!a.length)return!1;b=a.children("a").removeClass("jstree-hovered").parent(),this.data.ui.hovered[0]===b[0]&&(this.data.ui.hovered=null),this.__callback({obj:a})},select_node:function(a,b,c){a=this._get_node(a);if(a==-1||!a||!a.length)return!1;var e=this._get_settings().ui,f=e.select_multiple_modifier=="on"||e.select_multiple_modifier!==!1&&c&&c[e.select_multiple_modifier+"Key"],g=e.select_range_modifier!==!1&&c&&c[e.select_range_modifier+"Key"]&&this.data.ui.last_selected&&this.data.ui.last_selected[0]!==a[0]&&this.data.ui.last_selected.parent()[0]===a.parent()[0],h=this.is_selected(a),i=!0,j=this;if(b){if(e.disable_selecting_children&&f&&(a.parentsUntil(".jstree","li").children("a.jstree-clicked").length||a.children("ul").find("a.jstree-clicked:eq(0)").length))return!1;i=!1;switch(!0){case g:this.data.ui.last_selected.addClass("jstree-last-selected"),a=d(a[a.index()<this.data.ui.last_selected.index()?"nextUntil":"prevUntil"](".jstree-last-selected")),e.select_limit==-1||a.length<e.select_limit?(this.data.ui.last_selected.removeClass("jstree-last-selected"),this.data.ui.selected.each(function(){this!==j.data.ui.last_selected[0]&&j.deselect_node(this)}),h=!1,i=!0):i=!1;break;case h&&!f:this.deselect_all(),h=!1,i=!0;break;case!h&&!f:if(e.select_limit==-1||e.select_limit>0)this.deselect_all(),i=!0;break;case h&&f:this.deselect_node(a);break;case!h&&f:if(e.select_limit==-1||this.data.ui.selected.length+1<=e.select_limit)i=!0}}i&&!h&&(g||(this.data.ui.last_selected=a),a.children("a").addClass("jstree-clicked"),e.selected_parent_open&&a.parents(".jstree-closed").each(function(){j.open_node(this,!1,!0)}),this.data.ui.selected=this.data.ui.selected.add(a),this._fix_scroll(a.eq(0)),this.__callback({obj:a,e:c}))},_fix_scroll:function(a){var c=this.get_container()[0],d;if(c.scrollHeight>c.offsetHeight){a=this._get_node(a);if(!a||a===-1||!a.length||!a.is(":visible"))return;d=a.offset().top-this.get_container().offset().top,d<0&&(c.scrollTop=c.scrollTop+d-1),d+this.data.core.li_height+(c.scrollWidth>c.offsetWidth?b:0)>c.offsetHeight&&(c.scrollTop=c.scrollTop+(d-c.offsetHeight+this.data.core.li_height+1+(c.scrollWidth>c.offsetWidth?b:0)))}},deselect_node:function(a){a=this._get_node(a);if(!a.length)return!1;this.is_selected(a)&&(a.children("a").removeClass("jstree-clicked"),this.data.ui.selected=this.data.ui.selected.not(a),this.data.ui.last_selected.get(0)===a.get(0)&&(this.data.ui.last_selected=this.data.ui.selected.eq(0)),this.__callback({obj:a}))},toggle_select:function(a){a=this._get_node(a);if(!a.length)return!1;this.is_selected(a)?this.deselect_node(a):this.select_node(a)},is_selected:function(a){return this.data.ui.selected.index(this._get_node(a))>=0},get_selected:function(b){return b?a(b).find("a.jstree-clicked").parent():this.data.ui.selected},deselect_all:function(b){var c=b?a(b).find("a.jstree-clicked").parent():this.get_container().find("a.jstree-clicked").parent();c.children("a.jstree-clicked").removeClass("jstree-clicked"),this.data.ui.selected=a([]),this.data.ui.last_selected=!1,this.__callback({obj:c})}}}),a.jstree.defaults.plugins.push("ui")}(jQuery),function(a){a.jstree.plugin("crrm",{__init:function(){this.get_container().bind("move_node.jstree",a.proxy(function(a,b){if(this._get_settings().crrm.move.open_onmove){var c=this;d(b.rslt.np.parentsUntil(".jstree")).filter(".jstree-closed").each(function(){c.open_node(this,!1,!0)})}},this))},defaults:{input_width_limit:200,move:{always_copy:!1,open_onmove:!0,default_position:"last",check_move:function(a){return!0}}},_fn:{_show_input:function(b,c){b=this._get_node(b);var d=this._get_settings().core.rtl,e=this._get_settings().crrm.input_width_limit,f=b.children("ins").width(),g=b.find("> a:visible > ins").width()*b.find("> a:visible > ins").length,h=this.get_text(b),i=a("<div />",{css:{position:"absolute",top:"-200px",left:d?"0px":"-1000px",visibility:"hidden"}}).appendTo("body"),j=b.css("position","relative").append(a("<input />",{value:h,"class":"jstree-rename-input",css:{padding:"0",border:"1px solid silver",position:"absolute",left:d?"auto":f+g+4+"px",right:d?f+g+4+"px":"auto",top:"0px",height:this.data.core.li_height-2+"px",lineHeight:this.data.core.li_height-2+"px",width:"150px"},blur:a.proxy(function(){var a=b.children(".jstree-rename-input"),d=a.val();d===""&&(d=h),i.remove(),a.remove(),this.set_text(b,h),this.rename_node(b,d),c.call(this,b,d,h),b.css("position","")},this),keyup:function(a){var b=a.keyCode||a.which;if(b==27){this.value=h,this.blur();return}if(b==13){this.blur();return}j.width(Math.min(i.text("pW"+this.value).width(),e))},keypress:function(a){var b=a.keyCode||a.which;if(b==13)return!1}})).children(".jstree-rename-input");this.set_text(b,""),i.css({fontFamily:j.css("fontFamily")||"",fontSize:j.css("fontSize")||"",fontWeight:j.css("fontWeight")||"",fontStyle:j.css("fontStyle")||"",fontStretch:j.css("fontStretch")||"",fontVariant:j.css("fontVariant")||"",letterSpacing:j.css("letterSpacing")||"",wordSpacing:j.css("wordSpacing")||""}),j.width(Math.min(i.text("pW"+j[0].value).width(),e))[0].select()},rename:function(a){a=this._get_node(a),this.__rollback();var b=this.__callback;this._show_input(a,function(a,c,d){b.call(this,{obj:a,new_name:c,old_name:d})})},create:function(b,c,d,e,f){var g,h=this;return b=this._get_node(b),b||(b=-1),this.__rollback(),g=this.create_node(b,c,d,function(b){var c=this._get_parent(b),d=a(b).index();e&&e.call(this,b),c.length&&c.hasClass("jstree-closed")&&this.open_node(c,!1,!0),f?h.__callback({obj:b,name:this.get_text(b),parent:c,position:d}):this._show_input(b,function(a,b,e){h.__callback({obj:a,name:b,parent:c,position:d})})}),g},remove:function(a){a=this._get_node(a,!0);var b=this._get_parent(a),c=this._get_prev(a);this.__rollback(),a=this.delete_node(a),a!==!1&&this.__callback({obj:a,prev:c,parent:b})},check_move:function(){if(!this.__call_old())return!1;var a=this._get_settings().crrm.move;return a.check_move.call(this,this._get_move())?!0:!1},move_node:function(a,b,c,d,e,f){var g=this._get_settings().crrm.move;if(!e)return typeof c=="undefined"&&(c=g.default_position),c==="inside"&&typeof g.default_position!="undefined"&&!g.default_position.match(/^(before|after)$/)&&(c=g.default_position),this.__call_old(!0,a,b,c,d,!1,f);if(g.always_copy===!0||g.always_copy==="multitree"&&a.rt.get_index()!==a.ot.get_index())d=!0;this.__call_old(!0,a,b,c,d,!0,f)},cut:function(a){a=this._get_node(a,!0);if(!a||!a.length)return!1;this.data.crrm.cp_nodes=!1,this.data.crrm.ct_nodes=a,this.__callback({obj:a})},copy:function(a){a=this._get_node(a,!0);if(!a||!a.length)return!1;this.data.crrm.ct_nodes=!1,this.data.crrm.cp_nodes=a,this.__callback({obj:a})},paste:function(a){a=this._get_node(a);if(!a||!a.length)return!1;var b=this.data.crrm.ct_nodes?this.data.crrm.ct_nodes:this.data.crrm.cp_nodes;if(!this.data.crrm.ct_nodes&&!this.data.crrm.cp_nodes)return!1;this.data.crrm.ct_nodes&&(this.move_node(this.data.crrm.ct_nodes,a),this.data.crrm.ct_nodes=!1),this.data.crrm.cp_nodes&&this.move_node(this.data.crrm.cp_nodes,a,!1,!0),this.__callback({obj:a,nodes:b})}}})}(jQuery),function(a){var b=[];a.jstree._themes=!1,a.jstree.plugin("themes",{__init:function(){this.get_container().bind("init.jstree",a.proxy(function(){var a=this._get_settings().themes;this.data.themes.dots=a.dots,this.data.themes.icons=a.icons,this.set_theme(a.theme,a.url)},this)).bind("loaded.jstree",a.proxy(function(){this.data.themes.dots?this.show_dots():this.hide_dots(),this.data.themes.icons?this.show_icons():this.hide_icons()},this))},defaults:{theme:"default",url:!1,dots:!0,icons:!0},_fn:{set_theme:function(c,d){if(!c)return!1;d||(d=a.jstree._themes+c+"/style.css"),a.inArray(d,b)==-1&&(a.vakata.css.add_sheet({url:d}),b.push(d)),this.data.themes.theme!=c&&(this.get_container().removeClass("jstree-"+this.data.themes.theme),this.data.themes.theme=c),this.get_container().addClass("jstree-"+c),this.data.themes.dots?this.show_dots():this.hide_dots(),this.data.themes.icons?this.show_icons():this.hide_icons(),this.__callback()},get_theme:function(){return this.data.themes.theme},show_dots:function(){this.data.themes.dots=!0,this.get_container().children("ul").removeClass("jstree-no-dots")},hide_dots:function(){this.data.themes.dots=!1,this.get_container().children("ul").addClass("jstree-no-dots")},toggle_dots:function(){this.data.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this.data.themes.icons=!0,this.get_container().children("ul").removeClass("jstree-no-icons")},hide_icons:function(){this.data.themes.icons=!1,this.get_container().children("ul").addClass("jstree-no-icons")},toggle_icons:function(){this.data.themes.icons?this.hide_icons():this.show_icons()}}}),a(function(){a.jstree._themes===!1&&a("script").each(function(){if(this.src.toString().match(/jquery\.jstree[^\/]*?\.js(\?.*)?$/))return a.jstree._themes=this.src.toString().replace(/jquery\.jstree[^\/]*?\.js(\?.*)?$/,"")+"themes/",!1}),a.jstree._themes===!1&&(a.jstree._themes="themes/")}),a.jstree.defaults.plugins.push("themes")}(jQuery),function(a){function c(b,c){var d=a.jstree._focused(),e;if(d&&d.data&&d.data.hotkeys&&d.data.hotkeys.enabled){e=d._get_settings().hotkeys[b];if(e)return e.call(d,c)}}var b=[];a.jstree.plugin("hotkeys",{__init:function(){if(typeof a.hotkeys=="undefined")throw"jsTree hotkeys: jQuery hotkeys plugin not included.";if(!this.data.ui)throw"jsTree hotkeys: jsTree UI plugin not included.";a.each(this._get_settings().hotkeys,function(d,e){e!==!1&&a.inArray(d,b)==-1&&(a(document).bind("keydown",d,function(a){return c(d,a)}),b.push(d))}),this.get_container().bind("lock.jstree",a.proxy(function(){this.data.hotkeys.enabled&&(this.data.hotkeys.enabled=!1,this.data.hotkeys.revert=!0)},this)).bind("unlock.jstree",a.proxy(function(){this.data.hotkeys.revert&&(this.data.hotkeys.enabled=!0)},this)),this.enable_hotkeys()},defaults:{up:function(){var a=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_prev(a)),!1},"ctrl+up":function(){var a=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_prev(a)),!1},"shift+up":function(){var a=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_prev(a)),!1},down:function(){var a=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_next(a)),!1},"ctrl+down":function(){var a=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_next(a)),!1},"shift+down":function(){var a=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_next(a)),!1},left:function(){var a=this.data.ui.hovered||this.data.ui.last_selected;return a&&(a.hasClass("jstree-open")?this.close_node(a):this.hover_node(this._get_prev(a))),!1},"ctrl+left":function(){var a=this.data.ui.hovered||this.data.ui.last_selected;return a&&(a.hasClass("jstree-open")?this.close_node(a):this.hover_node(this._get_prev(a))),!1},"shift+left":function(){var a=this.data.ui.hovered||this.data.ui.last_selected;return a&&(a.hasClass("jstree-open")?this.close_node(a):this.hover_node(this._get_prev(a))),!1},right:function(){var a=this.data.ui.hovered||this.data.ui.last_selected;return a&&a.length&&(a.hasClass("jstree-closed")?this.open_node(a):this.hover_node(this._get_next(a))),!1},"ctrl+right":function(){var a=this.data.ui.hovered||this.data.ui.last_selected;return a&&a.length&&(a.hasClass("jstree-closed")?this.open_node(a):this.hover_node(this._get_next(a))),!1},"shift+right":function(){var a=this.data.ui.hovered||this.data.ui.last_selected;return a&&a.length&&(a.hasClass("jstree-closed")?this.open_node(a):this.hover_node(this._get_next(a))),!1},space:function(){return this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").click(),!1},"ctrl+space":function(a){return a.type="click",this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").trigger(a),!1},"shift+space":function(a){return a.type="click",this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").trigger(a),!1},f2:function(){this.rename(this.data.ui.hovered||this.data.ui.last_selected)},del:function(){this.remove(this.data.ui.hovered||this._get_node(null))}},_fn:{enable_hotkeys:function(){this.data.hotkeys.enabled=!0},disable_hotkeys:function(){this.data.hotkeys.enabled=!1}}})}(jQuery),function(a){a.jstree.plugin("json_data",{__init:function(){var a=this._get_settings().json_data;a.progressive_unload&&this.get_container().bind("after_close.jstree",function(a,b){b.rslt.obj.children("ul").remove()})},defaults:{data:!1,ajax:!1,correct_state:!0,progressive_render:!1,progressive_unload:!1},_fn:{load_node:function(a,b,c){var d=this;this.load_node_json(a,function(){d.__callback({obj:d._get_node(a)}),b.call(this)},c)},_is_loaded:function(b){var c=this._get_settings().json_data;return b=this._get_node(b),b==-1||!b||!c.ajax&&!c.progressive_render&&!a.isFunction(c.data)||b.is(".jstree-open, .jstree-leaf")||b.children("ul").children("li").length>0},refresh:function(b){b=this._get_node(b);var c=this._get_settings().json_data;return b&&b!==-1&&c.progressive_unload&&(a.isFunction(c.data)||!!c.ajax)&&b.removeData("jstree_children"),this.__call_old()},load_node_json:function(b,c,d){var e=this.get_settings().json_data,f,g=function(){},h=function(){};b=this._get_node(b);if(b&&b!==-1&&(e.progressive_render||e.progressive_unload)&&!b.is(".jstree-open, .jstree-leaf")&&b.children("ul").children("li").length===0&&b.data("jstree_children")){f=this._parse_json(b.data("jstree_children"),b),f&&(b.append(f),e.progressive_unload||b.removeData("jstree_children")),this.clean_node(b),c&&c.call(this);return}if(b&&b!==-1){if(b.data("jstree_is_loading"))return;b.data("jstree_is_loading",!0)}switch(!0){case!e.data&&!e.ajax:throw"Neither data nor ajax settings supplied.";case a.isFunction(e.data):e.data.call(this,b,a.proxy(function(a){a=this._parse_json(a,b),a?(b===-1||!b?this.get_container().children("ul").empty().append(a.children()):(b.append(a).children("a.jstree-loading").removeClass("jstree-loading"),b.removeData("jstree_is_loading")),this.clean_node(b),c&&c.call(this)):(b===-1||!b?e.correct_state&&this.get_container().children("ul").empty():(b.children("a.jstree-loading").removeClass("jstree-loading"),b.removeData("jstree_is_loading"),e.correct_state&&this.correct_state(b)),d&&d.call(this))},this));break;case!!e.data&&!e.ajax||!!e.data&&!!e.ajax&&(!b||b===-1):if(!b||b==-1)f=this._parse_json(e.data,b),f?(this.get_container().children("ul").empty().append(f.children()),this.clean_node()):e.correct_state&&this.get_container().children("ul").empty();c&&c.call(this);break;case!e.data&&!!e.ajax||!!e.data&&!!e.ajax&&b&&b!==-1:g=function(a,c,f){var g=this.get_settings().json_data.ajax.error;g&&g.call(this,a,c,f),b!=-1&&b.length?(b.children("a.jstree-loading").removeClass("jstree-loading"),b.removeData("jstree_is_loading"),c==="success"&&e.correct_state&&this.correct_state(b)):c==="success"&&e.correct_state&&this.get_container().children("ul").empty(),d&&d.call(this)},h=function(d,f,h){var i=this.get_settings().json_data.ajax.success;i&&(d=i.call(this,d,f,h)||d);if(d===""||d&&d.toString&&d.toString().replace(/^[\s\n]+$/,"")===""||!a.isArray(d)&&!a.isPlainObject(d))return g.call(this,h,f,"");d=this._parse_json(d,b),d?(b===-1||!b?this.get_container().children("ul").empty().append(d.children()):(b.append(d).children("a.jstree-loading").removeClass("jstree-loading"),b.removeData("jstree_is_loading")),this.clean_node(b),c&&c.call(this)):b===-1||!b?e.correct_state&&(this.get_container().children("ul").empty(),c&&c.call(this)):(b.children("a.jstree-loading").removeClass("jstree-loading"),b.removeData("jstree_is_loading"),e.correct_state&&(this.correct_state(b),c&&c.call(this)))},e.ajax.context=this,e.ajax.error=g,e.ajax.success=h,e.ajax.dataType||(e.ajax.dataType="json"),a.isFunction(e.ajax.url)&&(e.ajax.url=e.ajax.url.call(this,b)),a.isFunction(e.ajax.data)&&(e.ajax.data=e.ajax.data.call(this,b)),a.ajax(e.ajax)}},_parse_json:function(b,c,d){var e=!1,f=this._get_settings(),g=f.json_data,h=f.core.html_titles,i,j,k,l,m;if(!b)return e;g.progressive_unload&&c&&c!==-1&&c.data("jstree_children",e);if(a.isArray(b)){e=a();if(!b.length)return!1;for(j=0,k=b.length;j<k;j++)i=this._parse_json(b[j],c,!0),i.length&&(e=e.add(i))}else{typeof b=="string"&&(b={data:b});if(!b.data&&b.data!=="")return e;e=a("<li />"),b.attr&&e.attr(b.attr),b.metadata&&e.data(b.metadata),b.state&&e.addClass("jstree-"+b.state),a.isArray(b.data)||(i=b.data,b.data=[],b.data.push(i)),a.each(b.data,function(c,d){i=a("<a />"),a.isFunction(d)&&(d=d.call(this,b)),typeof d=="string"?i.attr("href","#")[h?"html":"text"](d):(d.attr||(d.attr={}),d.attr.href||(d.attr.href="#"),i.attr(d.attr)[h?"html":"text"](d.title),d.language&&i.addClass(d.language)),i.prepend("<ins class='jstree-icon'>&#160;</ins>"),!d.icon&&b.icon&&(d.icon=b.icon),d.icon&&(d.icon.indexOf("/")===-1?i.children("ins").addClass(d.icon):i.children("ins").css("background","url('"+d.icon+"') center center no-repeat")),e.append(i)}),e.prepend("<ins class='jstree-icon'>&#160;</ins>"),b.children&&(g.progressive_render&&b.state!=="open"?e.addClass("jstree-closed").data("jstree_children",b.children):(g.progressive_unload&&e.data("jstree_children",b.children),a.isArray(b.children)&&b.children.length&&(i=this._parse_json(b.children,c,!0),i.length&&(m=a("<ul />"),m.append(i),e.append(m)))))}return d||(l=a("<ul />"),l.append(e),e=l),e},get_json:function(b,c,d,e){var f=[],g=this._get_settings(),h=this,i,j,k,l,m,n;b=this._get_node(b);if(!b||b===-1)b=this.get_container().find("> ul > li");return c=a.isArray(c)?c:["id","class"],!e&&this.data.types&&c.push(g.types.type_attr),d=a.isArray(d)?d:[],b.each(function(){k=a(this),i={data:[]},c.length&&(i.attr={}),a.each(c,function(a,b){j=k.attr(b),j&&j.length&&j.replace(/jstree[^ ]*/ig,"").length&&(i.attr[b]=(" "+j).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))}),k.hasClass("jstree-open")&&(i.state="open"),k.hasClass("jstree-closed")&&(i.state="closed"),k.data()&&(i.metadata=k.data()),l=k.children("a"),l.each(function(){m=a(this),d.length||a.inArray("languages",g.plugins)!==-1||m.children("ins").get(0).style.backgroundImage.length||m.children("ins").get(0).className&&m.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").length?(n=!1,a.inArray("languages",g.plugins)!==-1&&a.isArray(g.languages)&&g.languages.length&&a.each(g.languages,function(a,b){if(m.hasClass(b))return n=b,!1}),j={attr:{},title:h.get_text(m,n)},a.each(d,function(a,b){j.attr[b]=(" "+(m.attr(b)||"")).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,"")}),a.inArray("languages",g.plugins)!==-1&&a.isArray(g.languages)&&g.languages.length&&a.each(g.languages,function(a,b){if(m.hasClass(b))return j.language=b,!0}),m.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"").length&&(j.icon=m.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,"")),m.children("ins").get(0).style.backgroundImage.length&&(j.icon=m.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")",""))):j=h.get_text(m),l.length>1?i.data.push(j):i.data=j}),k=k.find("> ul > li"),k.length&&(i.children=h.get_json(k,c,d,!0)),f.push(i)}),f}}})}(jQuery),function(a){var b=!1;a.jstree.plugin("languages",{__init:function(){this._load_css()},defaults:[],_fn:{set_lang:function(c){var d=this._get_settings().languages,e=!1,f=".jstree-"+this.get_index()+" a";if(!a.isArray(d)||d.length===0)return!1;if(a.inArray(c,d)==-1){if(!d[c])return!1;c=d[c]}return c==this.data.languages.current_language?!0:(e=a.vakata.css.get_css(f+"."+this.data.languages.current_language,!1,b),e!==!1&&(e.style.display="none"),e=a.vakata.css.get_css(f+"."+c,!1,b),e!==!1&&(e.style.display=""),this.data.languages.current_language=c,this.__callback(c),!0)},get_lang:function(){return this.data.languages.current_language},_get_string:function(b,c){var d=this._get_settings().languages,e=this._get_settings().core.strings;return a.isArray(d)&&d.length&&(c=c&&a.inArray(c,d)!=-1?c:this.data.languages.current_language),e[c]&&e[c][b]?e[c][b]:e[b]?e[b]:b},get_text:function(b,c){b=this._get_node(b)||this.data.ui.last_selected;if(!b.size())return!1;var d=this._get_settings().languages,e=this._get_settings().core.html_titles;return a.isArray(d)&&d.length?(c=c&&a.inArray(c,d)!=-1?c:this.data.languages.current_language,b=b.children("a."+c)):b=b.children("a:eq(0)"),e?(b=b.clone(),b.children("INS").remove(),b.html()):(b=b.contents().filter(function(){return this.nodeType==3})[0],b.nodeValue)},set_text:function(b,c,d){b=this._get_node(b)||this.data.ui.last_selected;if(!b.size())return!1;var e=this._get_settings().languages,f=this._get_settings().core.html_titles,g;return a.isArray(e)&&e.length?(d=d&&a.inArray(d,e)!=-1?d:this.data.languages.current_language,b=b.children("a."+d)):b=b.children("a:eq(0)"),f?(g=b.children("INS").clone(),b.html(c).prepend(g),this.__callback({obj:b,name:c,lang:d}),!0):(b=b.contents().filter(function(){return this.nodeType==3})[0],this.__callback({obj:b,name:c,lang:d}),b.nodeValue=c)},_load_css:function(){var c=this._get_settings().languages,d="/* languages css */",e=".jstree-"+this.get_index()+" a",f;if(a.isArray(c)&&c.length){this.data.languages.current_language=c[0];for(f=0;f<c.length;f++)d+=e+"."+c[f]+" {",c[f]!=this.data.languages.current_language&&(d+=" display:none; "),d+=" } ";b=a.vakata.css.add_sheet({str:d,title:"jstree-languages"})}},create_node:function(b,c,d,e){var f=this.__call_old(!0,b,c,d,function(b){var c=this._get_settings().languages,d=b.children("a"),f;if(a.isArray(c)&&c.length){for(f=0;f<c.length;f++)d.is("."+c[f])||b.append(d.eq(0).clone().removeClass(c.join(" ")).addClass(c[f]));d.not("."+c.join(", .")).remove()}e&&e.call(this,b)});return f}}})}(jQuery),function(a){a.jstree.plugin("cookies",{__init:function(){if(typeof a.cookie=="undefined")throw"jsTree cookie: jQuery cookie plugin not included.";var b=this._get_settings().cookies,c;!b.save_loaded||(c=a.cookie(b.save_loaded),c&&c.length&&(this.data.core.to_load=c.split(","))),!b.save_opened||(c=a.cookie(b.save_opened),c&&c.length&&(this.data.core.to_open=c.split(","))),!b.save_selected||(c=a.cookie(b.save_selected),c&&c.length&&this.data.ui&&(this.data.ui.to_select=c.split(","))),this.get_container().one((this.data.ui?"reselect":"reopen")+".jstree",a.proxy(function(){this.get_container().bind("open_node.jstree close_node.jstree select_node.jstree deselect_node.jstree",a.proxy(function(a){this._get_settings().cookies.auto_save&&this.save_cookie((a.handleObj.namespace+a.handleObj.type).replace("jstree",""))},this))},this))},defaults:{save_loaded:"jstree_load",save_opened:"jstree_open",save_selected:"jstree_select",auto_save:!0,cookie_options:{}},_fn:{save_cookie:function(b){if(this.data.core.refreshing)return;var c=this._get_settings().cookies;if(!b){c.save_loaded&&(this.save_loaded(),a.cookie(c.save_loaded,this.data.core.to_load.join(","),c.cookie_options)),c.save_opened&&(this.save_opened(),a.cookie(c.save_opened,this.data.core.to_open.join(","),c.cookie_options)),c.save_selected&&this.data.ui&&(this.save_selected(),a.cookie(c.save_selected,this.data.ui.to_select.join(","),c.cookie_options));return}switch(b){case"open_node":case"close_node":!c.save_opened||(this.save_opened(),a.cookie(c.save_opened,this.data.core.to_open.join(","),c.cookie_options)),!c.save_loaded||(this.save_loaded(),a.cookie(c.save_loaded,this.data.core.to_load.join(","),c.cookie_options));break;case"select_node":case"deselect_node":!!c.save_selected&&this.data.ui&&(this.save_selected(),a.cookie(c.save_selected,this.data.ui.to_select.join(","),c.cookie_options))}}}})}(jQuery),function(a){a.jstree.plugin("sort",{__init:function(){this.get_container().bind("load_node.jstree",a.proxy(function(a,b){var c=this._get_node(b.rslt.obj);c=c===-1?this.get_container().children("ul"):c.children("ul"),this.sort(c)},this)).bind("rename_node.jstree create_node.jstree create.jstree",a.proxy(function(a,b){this.sort(b.rslt.obj.parent())},this)).bind("move_node.jstree",a.proxy(function(a,b){var c=b.rslt.np==-1?this.get_container():b.rslt.np;this.sort(c.children("ul"))},this))},defaults:function(a,b){return this.get_text(a)>this.get_text(b)?1:-1},_fn:{sort:function(b){var c=this._get_settings().sort,d=this;b.append(a.makeArray(b.children("li")).sort(a.proxy(c,d))),b.find("> li > ul").each(function(){d.sort(a(this))}),this.clean_node(b)}}})}(jQuery),function(a){var b=!1,c=!1,d=!1,e=!1,f=!1,g=!1,h=!1,i=!1,j=!1;a.vakata.dnd={is_down:!1,is_drag:!1,helper:!1,scroll_spd:10,init_x:0,init_y:0,threshold:5,helper_left:5,helper_top:10,user_data:{},drag_start:function(b,c,d){a.vakata.dnd.is_drag&&a.vakata.drag_stop({});try{b.currentTarget.unselectable="on",b.currentTarget.onselectstart=function(){return!1},b.currentTarget.style&&(b.currentTarget.style.MozUserSelect="none")}catch(e){}return a.vakata.dnd.init_x=b.pageX,a.vakata.dnd.init_y=b.pageY,a.vakata.dnd.user_data=c,a.vakata.dnd.is_down=!0,a.vakata.dnd.helper=a("<div id='vakata-dragged' />").html(d),a(document).bind("mousemove",a.vakata.dnd.drag),a(document).bind("mouseup",a.vakata.dnd.drag_stop),!1},drag:function(b){if(!a.vakata.dnd.is_down)return;if(!a.vakata.dnd.is_drag)if(Math.abs(b.pageX-a.vakata.dnd.init_x)>5||Math.abs(b.pageY-a.vakata.dnd.init_y)>5)a.vakata.dnd.helper.appendTo("body"),a.vakata.dnd.is_drag=!0,a(document).triggerHandler("drag_start.vakata",{event:b,data:a.vakata.dnd.user_data});else return;if(b.type==="mousemove"){var c=a(document),d=c.scrollTop(),e=c.scrollLeft();b.pageY-d<20?(g&&h==="down"&&(clearInterval(g),g=!1),g||(h="up",g=setInterval(function(){a(document).scrollTop(a(document).scrollTop()-a.vakata.dnd.scroll_spd)},150))):g&&h==="up"&&(clearInterval(g),g=!1),a(window).height()-(b.pageY-d)<20?(g&&h==="up"&&(clearInterval(g),g=!1),g||(h="down",g=setInterval(function(){a(document).scrollTop(a(document).scrollTop()+a.vakata.dnd.scroll_spd)},150))):g&&h==="down"&&(clearInterval(g),g=!1),b.pageX-e<20?(f&&i==="right"&&(clearInterval(f),f=!1),f||(i="left",f=setInterval(function(){a(document).scrollLeft(a(document).scrollLeft()-a.vakata.dnd.scroll_spd)},150))):f&&i==="left"&&(clearInterval(f),f=!1),a(window).width()-(b.pageX-e)<20?(f&&i==="left"&&(clearInterval(f),f=!1),f||(i="right",f=setInterval(function(){a(document).scrollLeft(a(document).scrollLeft()+a.vakata.dnd.scroll_spd)},150))):f&&i==="right"&&(clearInterval(f),f=!1)}a.vakata.dnd.helper.css({left:b.pageX+a.vakata.dnd.helper_left+"px",top:b.pageY+a.vakata.dnd.helper_top+"px"}),a(document).triggerHandler("drag.vakata",{event:b,data:a.vakata.dnd.user_data})},drag_stop:function(b){f&&clearInterval(f),g&&clearInterval(g),a(document).unbind("mousemove",a.vakata.dnd.drag),a(document).unbind("mouseup",a.vakata.dnd.drag_stop),a(document).triggerHandler("drag_stop.vakata",{event:b,data:a.vakata.dnd.user_data}),a.vakata.dnd.helper.remove(),a.vakata.dnd.init_x=0,a.vakata.dnd.init_y=0,a.vakata.dnd.user_data={},a.vakata.dnd.is_down=!1,a.vakata.dnd.is_drag=!1}},a(function(){var b="#vakata-dragged { display:block; margin:0 0 0 0; padding:4px 4px 4px 24px; position:absolute; top:-2000px; line-height:16px; z-index:10000; } ";a.vakata.css.add_sheet({str:b,title:"vakata"})}),a.jstree.plugin("dnd",{__init:function(){this.data.dnd={active:!1,after:!1,inside:!1,before:!1,off:!1,prepared:!1,w:0,to1:!1,to2:!1,cof:!1,cw:!1,ch:!1,i1:!1,i2:!1,mto:!1},this.get_container().bind("mouseenter.jstree",a.proxy(function(c){if(a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree){this.data.themes&&(d.attr("class","jstree-"+this.data.themes.theme),e&&e.attr("class","jstree-"+this.data.themes.theme),a.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme));if(c.currentTarget===c.target&&a.vakata.dnd.user_data.obj&&a(a.vakata.dnd.user_data.obj).length&&a(a.vakata.dnd.user_data.obj).parents(".jstree:eq(0)")[0]!==c.target){var f=a.jstree._reference(c.target),g;f.data.dnd.foreign?(g=f._get_settings().dnd.drag_check.call(this,{o:b,r:f.get_container(),is_root:!0}),(g===!0||g.inside===!0||g.before===!0||g.after===!0)&&a.vakata.dnd.helper.children("ins").attr("class","jstree-ok")):(f.prepare_move(b,f.get_container(),"last"),f.check_move()&&a.vakata.dnd.helper.children("ins").attr("class","jstree-ok"))}}},this)).bind("mouseup.jstree",a.proxy(function(c){if(a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree&&c.currentTarget===c.target&&a.vakata.dnd.user_data.obj&&a(a.vakata.dnd.user_data.obj).length&&a(a.vakata.dnd.user_data.obj).parents(".jstree:eq(0)")[0]!==c.target){var d=a.jstree._reference(c.currentTarget),e;d.data.dnd.foreign?(e=d._get_settings().dnd.drag_check.call(this,{o:b,r:d.get_container(),is_root:!0}),(e===!0||e.inside===!0||e.before===!0||e.after===!0)&&d._get_settings().dnd.drag_finish.call(this,{o:b,r:d.get_container(),is_root:!0})):d.move_node(b,d.get_container(),"last",c[d._get_settings().dnd.copy_modifier+"Key"])}},this)).bind("mouseleave.jstree",a.proxy(function(b){if(b.relatedTarget&&b.relatedTarget.id&&b.relatedTarget.id==="jstree-marker-line")return!1;a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree&&(this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.to1&&clearTimeout(this.data.dnd.to1),this.data.dnd.to2&&clearTimeout(this.data.dnd.to2),a.vakata.dnd.helper.children("ins").hasClass("jstree-ok")&&a.vakata.dnd.helper.children("ins").attr("class","jstree-invalid"))},this)).bind("mousemove.jstree",a.proxy(function(b){if(a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree){var c=this.get_container()[0];b.pageX+24>this.data.dnd.cof.left+this.data.dnd.cw?(this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i1=setInterval(a.proxy(function(){this.scrollLeft+=a.vakata.dnd.scroll_spd},c),100)):b.pageX-24<this.data.dnd.cof.left?(this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i1=setInterval(a.proxy(function(){this.scrollLeft-=a.vakata.dnd.scroll_spd},c),100)):this.data.dnd.i1&&clearInterval(this.data.dnd.i1),b.pageY+24>this.data.dnd.cof.top+this.data.dnd.ch?(this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.i2=setInterval(a.proxy(function(){this.scrollTop+=a.vakata.dnd.scroll_spd},c),100)):b.pageY-24<this.data.dnd.cof.top?(this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.i2=setInterval(a.proxy(function(){this.scrollTop-=a.vakata.dnd.scroll_spd},c),100)):this.data.dnd.i2&&clearInterval(this.data.dnd.i2)}},this)).bind("scroll.jstree",a.proxy(function(b){a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree&&d&&e&&(d.hide(),e.hide())},this)).delegate("a","mousedown.jstree",a.proxy(function(a){if(a.which===1)return this.start_drag(a.currentTarget,a),!1},this)).delegate("a","mouseenter.jstree",a.proxy(function(b){a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree&&this.dnd_enter(b.currentTarget)},this)).delegate("a","mousemove.jstree",a.proxy(function(b){a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree&&((!c||!c.length||c.children("a")[0]!==b.currentTarget)&&this.dnd_enter(b.currentTarget),typeof this.data.dnd.off.top=="undefined"&&(this.data.dnd.off=a(b.target).offset()),this.data.dnd.w=(b.pageY-(this.data.dnd.off.top||0))%this.data.core.li_height,this.data.dnd.w<0&&(this.data.dnd.w+=this.data.core.li_height),this.dnd_show())},this)).delegate("a","mouseleave.jstree",a.proxy(function(b){if(a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree){if(b.relatedTarget&&b.relatedTarget.id&&b.relatedTarget.id==="jstree-marker-line")return!1;d&&d.hide(),e&&e.hide(),this.data.dnd.mto=setTimeout(function(a){return function(){a.dnd_leave(b)}}(this),0)}},this)).delegate("a","mouseup.jstree",a.proxy(function(b){a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree&&this.dnd_finish(b)},this)),a(document).bind("drag_stop.vakata",a.proxy(function(){this.data.dnd.to1&&clearTimeout(this.data.dnd.to1),this.data.dnd.to2&&clearTimeout(this.data.dnd.to2),this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.after=!1,this.data.dnd.before=!1,this.data.dnd.inside=!1,this.data.dnd.off=!1,this.data.dnd.prepared=!1,this.data.dnd.w=!1,this.data.dnd.to1=!1,this.data.dnd.to2=!1,this.data.dnd.i1=!1,this.data.dnd.i2=!1,this.data.dnd.active=!1,this.data.dnd.foreign=!1,d&&d.css({top:"-2000px"}),e&&e.css({top:"-2000px"})},this)).bind("drag_start.vakata",a.proxy(function(b,c){if(c.data.jstree){var d=a(c.event.target);d.closest(".jstree").hasClass("jstree-"+this.get_index())&&this.dnd_enter(d)}},this));var f=this._get_settings().dnd;f.drag_target&&a(document).delegate(f.drag_target,"mousedown.jstree-"+this.get_index(),a.proxy(function(c){b=c.target,a.vakata.dnd.drag_start(c,{jstree:!0,obj:c.target},"<ins class='jstree-icon'></ins>"+a(c.target).text()),this.data.themes&&(d&&d.attr("class","jstree-"+this.data.themes.theme),e&&e.attr("class","jstree-"+this.data.themes.theme),a.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)),a.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");var f=this.get_container();this.data.dnd.cof=f.offset(),this.data.dnd.cw=parseInt(f.width(),10),this.data.dnd.ch=parseInt(f.height(),10),this.data.dnd.foreign=!0,c.preventDefault()},this)),f.drop_target&&a(document).delegate(f.drop_target,"mouseenter.jstree-"+this.get_index(),a.proxy(function(c){this.data.dnd.active&&this._get_settings().dnd.drop_check.call(this,{o:b,r:a(c.target),e:c})&&a.vakata.dnd.helper.children("ins").attr("class","jstree-ok")},this)).delegate(f.drop_target,"mouseleave.jstree-"+this.get_index(),a.proxy(function(b){this.data.dnd.active&&a.vakata.dnd.helper.children("ins").attr("class","jstree-invalid")},this)).delegate(f.drop_target,"mouseup.jstree-"+this.get_index(),a.proxy(function(c){this.data.dnd.active&&a.vakata.dnd.helper.children("ins").hasClass("jstree-ok")&&this._get_settings().dnd.drop_finish.call(this,{o:b,r:a(c.target),e:c})},this))},defaults:{copy_modifier:"ctrl",check_timeout:100,open_timeout:500,drop_target:".jstree-drop",drop_check:function(a){return!0},drop_finish:a.noop,drag_target:".jstree-draggable",drag_finish:a.noop,drag_check:function(a){return{after:!1,before:!1,inside:!0}}},_fn:{dnd_prepare:function(){if(!c||!c.length)return;this.data.dnd.off=c.offset(),this._get_settings().core.rtl&&(this.data.dnd.off.right=this.data.dnd.off.left+c.width());if(this.data.dnd.foreign){var a=this._get_settings().dnd.drag_check.call(this,{o:b,r:c});return this.data.dnd.after=a.after,this.data.dnd.before=a.before,this.data.dnd.inside=a.inside,this.data.dnd.prepared=!0,this.dnd_show()}return this.prepare_move(b,c,"before"),this.data.dnd.before=this.check_move(),this.prepare_move(b,c,"after"),this.data.dnd.after=this.check_move(),this._is_loaded(c)?(this.prepare_move(b,c,"inside"),this.data.dnd.inside=this.check_move()):this.data.dnd.inside=!1,this.data.dnd.prepared=!0,this.dnd_show()},dnd_show:function(){if(!this.data.dnd.prepared)return;var b=["before","inside","after"],c=!1,f=this._get_settings().core.rtl,g;this.data.dnd.w<this.data.core.li_height/3?b=["before","inside","after"]:this.data.dnd.w<=this.data.core.li_height*2/3?b=this.data.dnd.w<this.data.core.li_height/2?["inside","before","after"]:["inside","after","before"]:b=["after","inside","before"],a.each(b,a.proxy(function(b,d){if(this.data.dnd[d])return a.vakata.dnd.helper.children("ins").attr("class","jstree-ok"),c=d,!1},this)),c===!1&&a.vakata.dnd.helper.children("ins").attr("class","jstree-invalid"),g=f?this.data.dnd.off.right-18:this.data.dnd.off.left+10;switch(c){case"before":d.css({left:g+"px",top:this.data.dnd.off.top-6+"px"}).show(),e&&e.css({left:g+8+"px",top:this.data.dnd.off.top-1+"px"}).show();break;case"after":d.css({left:g+"px",top:this.data.dnd.off.top+this.data.core.li_height-6+"px"}).show(),e&&e.css({left:g+8+"px",top:this.data.dnd.off.top+this.data.core.li_height-1+"px"}).show();break;case"inside":d.css({left:g+(f?-4:4)+"px",top:this.data.dnd.off.top+this.data.core.li_height/2-5+"px"}).show(),e&&e.hide();break;default:d.hide(),e&&e.hide()}return j=c,c},dnd_open:function(){this.data.dnd.to2=!1,this.open_node(c,a.proxy(this.dnd_prepare,this),!0)},dnd_finish:function(a){this.data.dnd.foreign?(this.data.dnd.after||this.data.dnd.before||this.data.dnd.inside)&&this._get_settings().dnd.drag_finish.call(this,{o:b,r:c,p:j}):(this.dnd_prepare(),this.move_node(b,c,j,a[this._get_settings().dnd.copy_modifier+"Key"])),b=!1,c=!1,d.hide(),e&&e.hide()},dnd_enter:function(b){this.data.dnd.mto&&(clearTimeout(this.data.dnd.mto),this.data.dnd.mto=!1);var d=this._get_settings().dnd;this.data.dnd.prepared=!1,c=this._get_node(b),d.check_timeout?(this.data.dnd.to1&&clearTimeout(this.data.dnd.to1),this.data.dnd.to1=setTimeout(a.proxy(this.dnd_prepare,this),d.check_timeout)):this.dnd_prepare(),d.open_timeout?(this.data.dnd.to2&&clearTimeout(this.data.dnd.to2),c&&c.length&&c.hasClass("jstree-closed")&&(this.data.dnd.to2=setTimeout(a.proxy(this.dnd_open,this),d.open_timeout))):c&&c.length&&c.hasClass("jstree-closed")&&this.dnd_open()},dnd_leave:function(b){this.data.dnd.after=!1,this.data.dnd.before=!1,this.data.dnd.inside=!1,a.vakata.dnd.helper.children("ins").attr("class","jstree-invalid"),d.hide(),e&&e.hide(),c&&c[0]===b.target.parentNode&&(this.data.dnd.to1&&(clearTimeout(this.data.dnd.to1),this.data.dnd.to1=!1),this.data.dnd.to2&&(clearTimeout(this.data.dnd.to2),this.data.dnd.to2=!1))},start_drag:function(c,f){b=this._get_node(c),this.data.ui&&this.is_selected(b)&&(b=this._get_node(null,!0));var g=b.length>1?this._get_string("multiple_selection"):this.get_text(b),h=this.get_container();this._get_settings().core.html_titles||(g=g.replace(/</ig,"&lt;").replace(/>/ig,"&gt;")),a.vakata.dnd.drag_start(f,{jstree:!0,obj:b},"<ins class='jstree-icon'></ins>"+g),this.data.themes&&(d&&d.attr("class","jstree-"+this.data.themes.theme),e&&e.attr("class","jstree-"+this.data.themes.theme),a.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)),this.data.dnd.cof=h.offset(),this.data.dnd.cw=parseInt(h.width(),10),this.data.dnd.ch=parseInt(h.height(),10),this.data.dnd.active=!0}}}),a(function(){var b="#vakata-dragged ins { display:block; text-decoration:none; width:16px; height:16px; margin:0 0 0 0; padding:0; position:absolute; top:4px; left:4px;  -moz-border-radius:4px; border-radius:4px; -webkit-border-radius:4px; } #vakata-dragged .jstree-ok { background:green; } #vakata-dragged .jstree-invalid { background:red; } #jstree-marker { padding:0; margin:0; font-size:12px; overflow:hidden; height:12px; width:8px; position:absolute; top:-30px; z-index:10001; background-repeat:no-repeat; display:none; background-color:transparent; text-shadow:1px 1px 1px white; color:black; line-height:10px; } #jstree-marker-line { padding:0; margin:0; line-height:0%; font-size:1px; overflow:hidden; height:1px; width:100px; position:absolute; top:-30px; z-index:10000; background-repeat:no-repeat; display:none; background-color:#456c43;  cursor:pointer; border:1px solid #eeeeee; border-left:0; -moz-box-shadow: 0px 0px 2px #666; -webkit-box-shadow: 0px 0px 2px #666; box-shadow: 0px 0px 2px #666;  -moz-border-radius:1px; border-radius:1px; -webkit-border-radius:1px; }";a.vakata.css.add_sheet({str:b,title:"jstree"}),d=a("<div />").attr({id:"jstree-marker"}).hide().html("&raquo;").bind("mouseleave mouseenter",function(a){return d.hide(),e.hide(),a.preventDefault(),a.stopImmediatePropagation(),!1}).appendTo("body"),e=a("<div />").attr({id:"jstree-marker-line"}).hide().bind("mouseup",function(a){if(c&&c.length)return c.children("a").trigger(a),a.preventDefault(),a.stopImmediatePropagation(),!1}).bind("mouseleave",function(b){var f=a(b.relatedTarget);if(f.is(".jstree")||f.closest(".jstree").length===0)if(c&&c.length)return c.children("a").trigger(b),d.hide(),e.hide(),b.preventDefault(),b.stopImmediatePropagation(),!1}).appendTo("body"),a(document).bind("drag_start.vakata",function(a,b){b.data.jstree&&(d.show(),e&&e.show())}),a(document).bind("drag_stop.vakata",function(a,b){b.data.jstree&&(d.hide(),e&&e.hide())})})}(jQuery),function(a){a.jstree.plugin("checkbox",{__init:function(){this.data.checkbox.noui=this._get_settings().checkbox.override_ui,this.data.ui&&this.data.checkbox.noui&&(this.select_node=this.deselect_node=this.deselect_all=a.noop,this.get_selected=this.get_checked),this.get_container().bind("open_node.jstree create_node.jstree clean_node.jstree refresh.jstree",a.proxy(function(a,b){this._prepare_checkboxes(b.rslt.obj)},this)).bind("loaded.jstree",a.proxy(function(a){this._prepare_checkboxes()},this)).delegate(this.data.ui&&this.data.checkbox.noui?"a":"ins.jstree-checkbox","click.jstree",a.proxy(function(a){a.preventDefault(),this._get_node(a.target).hasClass("jstree-checked")?this.uncheck_node(a.target):this.check_node(a.target);if(this.data.ui&&this.data.checkbox.noui)this.save_selected(),this.data.cookies&&this.save_cookie("select_node");else return a.stopImmediatePropagation(),!1},this))},defaults:{override_ui:!1,two_state:!1,real_checkboxes:!1,checked_parent_open:!0,real_checkboxes_names:function(a){return["check_"+(a[0].id||Math.ceil(Math.random()*1e4)),1]}},__destroy:function(){this.get_container().find("input.jstree-real-checkbox").removeClass("jstree-real-checkbox").end().find("ins.jstree-checkbox").remove()},_fn:{_checkbox_notify:function(a,b){b.checked&&this.check_node(a,!1)},_prepare_checkboxes:function(b){b=!b||b==-1?this.get_container().find("> ul > li"):this._get_node(b);if(b===!1)return;var c,e=this,f,g=this._get_settings().checkbox.two_state,h=this._get_settings().checkbox.real_checkboxes,i=this._get_settings().checkbox.real_checkboxes_names;b.each(function(){f=a(this),c=f.is("li")&&(f.hasClass("jstree-checked")||h&&f.children(":checked").length)?"jstree-checked":"jstree-unchecked",d(f.find("li")).each(function(){var b=a(this),f;b.children("a"+(e.data.languages?"":":eq(0)")).not(":has(.jstree-checkbox)").prepend("<ins class='jstree-checkbox'>&#160;</ins>").parent().not(".jstree-checked, .jstree-unchecked").addClass(g?"jstree-unchecked":c),h&&(b.children(":checkbox").length?b.children(":checkbox").addClass("jstree-real-checkbox"):(f=i.call(e,b),b.prepend("<input type='checkbox' class='jstree-real-checkbox' id='"+f[0]+"' name='"+f[0]+"' value='"+f[1]+"' />"))),g?(b.hasClass("jstree-checked")||b.children(":checked").length)&&b.addClass("jstree-checked").children(":checkbox").prop("checked",!0):(c==="jstree-checked"||b.hasClass("jstree-checked")||b.children(":checked").length)&&d(b.find("li")).addClass("jstree-checked").children(":checkbox").prop("checked",!0)})}),g||b.find(".jstree-checked").parent().parent().each(function(){e._repair_state(this)})},change_state:function(b,c){b=this._get_node(b);var e=!1,f=this._get_settings().checkbox.real_checkboxes;if(!b||b===-1)return!1;c=c===!1||c===!0?c:b.hasClass("jstree-checked");if(this._get_settings().checkbox.two_state)c?(b.removeClass("jstree-checked").addClass("jstree-unchecked"),f&&b.children(":checkbox").prop("checked",!1)):(b.removeClass("jstree-unchecked").addClass("jstree-checked"),f&&b.children(":checkbox").prop("checked",!0));else{if(c){e=d(b.find("li"));if(!e.filter(".jstree-checked, .jstree-undetermined").length)return!1;e.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked"),f&&e.children(":checkbox").prop("checked",!1)}else{e=d(b.find("li"));if(!e.filter(".jstree-unchecked, .jstree-undetermined").length)return!1;e.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked"),f&&e.children(":checkbox").prop("checked",!0),this.data.ui&&(this.data.ui.last_selected=b),this.data.checkbox.last_selected=b}b.parentsUntil(".jstree","li").each(function(){var b=a(this);if(c){if(b.children("ul").children("li.jstree-checked, li.jstree-undetermined").length)return d(b.parentsUntil(".jstree","li")).removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),f&&d(b.parentsUntil(".jstree","li")).children(":checkbox").prop("checked",!1),!1;b.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked"),f&&b.children(":checkbox").prop("checked",!1)}else{if(b.children("ul").children("li.jstree-unchecked, li.jstree-undetermined").length)return d(b.parentsUntil(".jstree","li")).removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),f&&d(b.parentsUntil(".jstree","li")).children(":checkbox").prop("checked",!1),!1;b.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked"),f&&b.children(":checkbox").prop("checked",!0)}})}return this.data.ui&&this.data.checkbox.noui&&(this.data.ui.selected=this.get_checked()),this.__callback(b),!0},check_node:function(a){if(this.change_state(a,!1)){a=this._get_node(a);if(this._get_settings().checkbox.checked_parent_open){var b=this;a.parents(".jstree-closed").each(function(){b.open_node(this,!1,!0)})}this.__callback({obj:a})}},uncheck_node:function(a){this.change_state(a,!0)&&this.__callback({obj:this._get_node(a)})},check_all:function(){var a=this,b=this._get_settings().checkbox.two_state?this.get_container_ul().find("li"):this.get_container_ul().children("li");b.each(function(){a.change_state(this,!1)}),this.__callback()},uncheck_all:function(){var a=this,b=this._get_settings().checkbox.two_state?this.get_container_ul().find("li"):this.get_container_ul().children("li");b.each(function(){a.change_state(this,!0)}),this.__callback()},is_checked:function(a){return a=this._get_node(a),a.length?a.is(".jstree-checked"):!1},get_checked:function(a,b){return a=!a||a===-1?this.get_container():this._get_node(a),b||this._get_settings().checkbox.two_state?a.find(".jstree-checked"):a.find("> ul > .jstree-checked, .jstree-undetermined > ul > .jstree-checked")},get_unchecked:function(a,b){return a=!a||a===-1?this.get_container():this._get_node(a),b||this._get_settings().checkbox.two_state?a.find(".jstree-unchecked"):a.find("> ul > .jstree-unchecked, .jstree-undetermined > ul > .jstree-unchecked")},show_checkboxes:function(){this.get_container().children("ul").removeClass("jstree-no-checkboxes")},hide_checkboxes:function(){this.get_container().children("ul").addClass("jstree-no-checkboxes")},_repair_state:function(a){a=this._get_node(a);if(!a.length)return;if(this._get_settings().checkbox.two_state){d(a.find("li")).not(".jstree-checked").removeClass("jstree-undetermined").addClass("jstree-unchecked").children(":checkbox").prop("checked",!0);return}var b=this._get_settings().checkbox.real_checkboxes,c=a.find("> ul > .jstree-checked").length,e=a.find("> ul > .jstree-undetermined").length,f=a.find("> ul > li").length;f===0?a.hasClass("jstree-undetermined")&&this.change_state(a,!1):c===0&&e===0?this.change_state(a,!0):c===f?this.change_state(a,!1):(d(a.parentsUntil(".jstree","li")).removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),b&&d(a.parentsUntil(".jstree","li")).children(":checkbox").prop("checked",!1))},reselect:function(){if(this.data.ui&&this.data.checkbox.noui){var b=this,c=this.data.ui.to_select;c=a.map(a.makeArray(c),function(a){return"#"+a.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")}),this.deselect_all(),a.each(c,function(a,c){b.check_node(c)}),this.__callback()}else this.__call_old()},save_loaded:function(){var a=this;this.data.core.to_load=[],this.get_container_ul().find("li.jstree-closed.jstree-undetermined").each(function(){this.id&&a.data.core.to_load.push("#"+this.id)})}}}),a(function(){var b=".jstree .jstree-real-checkbox { display:none; } ";a.vakata.css.add_sheet({str:b,title:"jstree"})})}(jQuery),function(a){a.vakata.xslt=function(b,c,d){var e=!1,f,g,h;if(e===!1&&window.ActiveXObject)try{e=new ActiveXObject("Msxml2.XSLTemplate"),g=new ActiveXObject("Msxml2.DOMDocument"),g.loadXML(b),h=new ActiveXObject("Msxml2.FreeThreadedDOMDocument"),h.loadXML(c),e.stylesheet=h,f=e.createProcessor(),f.input=g,f.transform(),e=f.output}catch(i){}b=a.parseXML(b),c=a.parseXML(c),e===!1&&typeof XSLTProcessor!="undefined"&&(f=new XSLTProcessor,f.importStylesheet(c),e=f.transformToFragment(b,document),e=a("<div />").append(e).html()),e===!1&&typeof b.transformNode!="undefined"&&(e=b.transformNode(c)),d.call(null,e)};var b={nest:'<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/html" /><xsl:template match="/">\t<xsl:call-template name="nodes">\t\t<xsl:with-param name="node" select="/root" />\t</xsl:call-template></xsl:template><xsl:template name="nodes">\t<xsl:param name="node" />\t<ul>\t<xsl:for-each select="$node/item">\t\t<xsl:variable name="children" select="count(./item) &gt; 0" />\t\t<li>\t\t\t<xsl:attribute name="class">\t\t\t\t<xsl:if test="position() = last()">jstree-last </xsl:if>\t\t\t\t<xsl:choose>\t\t\t\t\t<xsl:when test="@state = \'open\'">jstree-open </xsl:when>\t\t\t\t\t<xsl:when test="$children or @hasChildren or @state = \'closed\'">jstree-closed </xsl:when>\t\t\t\t\t<xsl:otherwise>jstree-leaf </xsl:otherwise>\t\t\t\t</xsl:choose>\t\t\t\t<xsl:value-of select="@class" />\t\t\t</xsl:attribute>\t\t\t<xsl:for-each select="@*">\t\t\t\t<xsl:if test="name() != \'class\' and name() != \'state\' and name() != \'hasChildren\'">\t\t\t\t\t<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>\t\t\t\t</xsl:if>\t\t\t</xsl:for-each>\t<ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>\t\t\t<xsl:for-each select="content/name">\t\t\t\t<a>\t\t\t\t<xsl:attribute name="href">\t\t\t\t\t<xsl:choose>\t\t\t\t\t<xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>\t\t\t\t\t<xsl:otherwise>#</xsl:otherwise>\t\t\t\t\t</xsl:choose>\t\t\t\t</xsl:attribute>\t\t\t\t<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>\t\t\t\t<xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>\t\t\t\t<xsl:for-each select="@*">\t\t\t\t\t<xsl:if test="name() != \'style\' and name() != \'class\' and name() != \'href\'">\t\t\t\t\t\t<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>\t\t\t\t\t</xsl:if>\t\t\t\t</xsl:for-each>\t\t\t\t\t<ins>\t\t\t\t\t\t<xsl:attribute name="class">jstree-icon \t\t\t\t\t\t\t<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>\t\t\t\t\t\t</xsl:attribute>\t\t\t\t\t\t<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>\t\t\t\t\t\t<xsl:text>&#xa0;</xsl:text>\t\t\t\t\t</ins>\t\t\t\t\t<xsl:copy-of select="./child::node()" />\t\t\t\t</a>\t\t\t</xsl:for-each>\t\t\t<xsl:if test="$children or @hasChildren"><xsl:call-template name="nodes"><xsl:with-param name="node" select="current()" /></xsl:call-template></xsl:if>\t\t</li>\t</xsl:for-each>\t</ul></xsl:template></xsl:stylesheet>',flat:'<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/xml" /><xsl:template match="/">\t<ul>\t<xsl:for-each select="//item[not(@parent_id) or @parent_id=0 or not(@parent_id = //item/@id)]">\t\t<xsl:call-template name="nodes">\t\t\t<xsl:with-param name="node" select="." />\t\t\t<xsl:with-param name="is_last" select="number(position() = last())" />\t\t</xsl:call-template>\t</xsl:for-each>\t</ul></xsl:template><xsl:template name="nodes">\t<xsl:param name="node" />\t<xsl:param name="is_last" />\t<xsl:variable name="children" select="count(//item[@parent_id=$node/attribute::id]) &gt; 0" />\t<li>\t<xsl:attribute name="class">\t\t<xsl:if test="$is_last = true()">jstree-last </xsl:if>\t\t<xsl:choose>\t\t\t<xsl:when test="@state = \'open\'">jstree-open </xsl:when>\t\t\t<xsl:when test="$children or @hasChildren or @state = \'closed\'">jstree-closed </xsl:when>\t\t\t<xsl:otherwise>jstree-leaf </xsl:otherwise>\t\t</xsl:choose>\t\t<xsl:value-of select="@class" />\t</xsl:attribute>\t<xsl:for-each select="@*">\t\t<xsl:if test="name() != \'parent_id\' and name() != \'hasChildren\' and name() != \'class\' and name() != \'state\'">\t\t<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>\t\t</xsl:if>\t</xsl:for-each>\t<ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>\t<xsl:for-each select="content/name">\t\t<a>\t\t<xsl:attribute name="href">\t\t\t<xsl:choose>\t\t\t<xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>\t\t\t<xsl:otherwise>#</xsl:otherwise>\t\t\t</xsl:choose>\t\t</xsl:attribute>\t\t<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>\t\t<xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>\t\t<xsl:for-each select="@*">\t\t\t<xsl:if test="name() != \'style\' and name() != \'class\' and name() != \'href\'">\t\t\t\t<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>\t\t\t</xsl:if>\t\t</xsl:for-each>\t\t\t<ins>\t\t\t\t<xsl:attribute name="class">jstree-icon \t\t\t\t\t<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>\t\t\t\t</xsl:attribute>\t\t\t\t<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>\t\t\t\t<xsl:text>&#xa0;</xsl:text>\t\t\t</ins>\t\t\t<xsl:copy-of select="./child::node()" />\t\t</a>\t</xsl:for-each>\t<xsl:if test="$children">\t\t<ul>\t\t<xsl:for-each select="//item[@parent_id=$node/attribute::id]">\t\t\t<xsl:call-template name="nodes">\t\t\t\t<xsl:with-param name="node" select="." />\t\t\t\t<xsl:with-param name="is_last" select="number(position() = last())" />\t\t\t</xsl:call-template>\t\t</xsl:for-each>\t\t</ul>\t</xsl:if>\t</li></xsl:template></xsl:stylesheet>'},c=function(a){return a.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")};a.jstree.plugin("xml_data",{defaults:{data:!1,ajax:!1,xsl:"flat",clean_node:!1,correct_state:!0,get_skip_empty:!1,get_include_preamble:!0},_fn:{load_node:function(a,b,c){var d=this;this.load_node_xml(a,function(){d.__callback({obj:d._get_node(a)}),b.call(this)},c)},_is_loaded:function(b){var c=this._get_settings().xml_data;return b=this._get_node(b),b==-1||!b||!c.ajax&&!a.isFunction(c.data)||b.is(".jstree-open, .jstree-leaf")||b.children("ul").children("li").size()>0},load_node_xml:function(b,c,d){var e=this.get_settings().xml_data,f=function(){},g=function(){};b=this._get_node(b);if(b&&b!==-1){if(b.data("jstree_is_loading"))return;b.data("jstree_is_loading",!0)}switch(!0){case!e.data&&!e.ajax:throw"Neither data nor ajax settings supplied.";case a.isFunction(e.data):e.data.call(this,b,a.proxy(function(d){this.parse_xml(d,a.proxy(function(d){d&&(d=d.replace(/ ?xmlns="[^"]*"/ig,""),d.length>10?(d=a(d),b===-1||!b?this.get_container().children("ul").empty().append(d.children()):(b.children("a.jstree-loading").removeClass("jstree-loading"),b.append(d),b.removeData("jstree_is_loading")),e.clean_node&&this.clean_node(b),c&&c.call(this)):b&&b!==-1?(b.children("a.jstree-loading").removeClass("jstree-loading"),b.removeData("jstree_is_loading"),e.correct_state&&(this.correct_state(b),c&&c.call(this))):e.correct_state&&(this.get_container().children("ul").empty(),c&&c.call(this)))},this))},this));break;case!!e.data&&!e.ajax||!!e.data&&!!e.ajax&&(!b||b===-1):(!b||b==-1)&&this.parse_xml(e.data,a.proxy(function(d){d?(d=d.replace(/ ?xmlns="[^"]*"/ig,""),d.length>10&&(d=a(d),this.get_container().children("ul").empty().append(d.children()),e.clean_node&&this.clean_node(b),c&&c.call(this))):e.correct_state&&(this.get_container().children("ul").empty(),c&&c.call(this))},this));break;case!e.data&&!!e.ajax||!!e.data&&!!e.ajax&&b&&b!==-1:f=function(a,c,f){var g=this.get_settings().xml_data.ajax.error;g&&g.call(this,a,c,f),b!==-1&&b.length?(b.children("a.jstree-loading").removeClass("jstree-loading"),b.removeData("jstree_is_loading"),c==="success"&&e.correct_state&&this.correct_state(b)):c==="success"&&e.correct_state&&this.get_container().children("ul").empty(),d&&d.call(this)},g=function(d,g,h){d=h.responseText;var i=this.get_settings().xml_data.ajax.success;i&&(d=i.call(this,d,g,h)||d);if(d===""||d&&d.toString&&d.toString().replace(/^[\s\n]+$/,"")==="")return f.call(this,h,g,"");this.parse_xml(d,a.proxy(function(d){d&&(d=d.replace(/ ?xmlns="[^"]*"/ig,""),d.length>10?(d=a(d),b===-1||!b?this.get_container().children("ul").empty().append(d.children()):(b.children("a.jstree-loading").removeClass("jstree-loading"),b.append(d),b.removeData("jstree_is_loading")),e.clean_node&&this.clean_node(b),c&&c.call(this)):b&&b!==-1?(b.children("a.jstree-loading").removeClass("jstree-loading"),b.removeData("jstree_is_loading"),e.correct_state&&(this.correct_state(b),c&&c.call(this))):e.correct_state&&(this.get_container().children("ul").empty(),c&&c.call(this)))},this))},e.ajax.context=this,e.ajax.error=f,e.ajax.success=g,e.ajax.dataType||(e.ajax.dataType="xml"),a.isFunction(e.ajax.url)&&(e.ajax.url=e.ajax.url.call(this,b)),a.isFunction(e.ajax.data)&&(e.ajax.data=e.ajax.data.call(this,b)),a.ajax(e.ajax)}},parse_xml:function(c,d){var e=this._get_settings().xml_data;a.vakata.xslt(c,b[e.xsl],d)},get_xml:function(b,d,e,f,g){var h="",i=this._get_settings(),j=this,k,l,m,n,o;b||(b="flat"),g||(g=0),d=this._get_node(d);if(!d||d===-1)d=this.get_container().find("> ul > li");return e=a.isArray(e)?e:["id","class"],!g&&this.data.types&&a.inArray(i.types.type_attr,e)===-1&&e.push(i.types.type_attr),f=a.isArray(f)?f:[],g||(i.xml_data.get_include_preamble&&(h+='<?xml version="1.0" encoding="UTF-8"?>'),h+="<root>"),d.each(function(){h+="<item",m=a(this),a.each(e,function(a,b){var d=m.attr(b);if(!i.xml_data.get_skip_empty||typeof d!="undefined")h+=" "+b+'="'+c((" "+(d||"")).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+'"'}),m.hasClass("jstree-open")&&(h+=' state="open"'),m.hasClass("jstree-closed")&&(h+=' state="closed"'),b==="flat"&&(h+=' parent_id="'+c(g)+'"'),h+=">",h+="<content>",n=m.children("a"),n.each(function(){k=a(this),o=!1,h+="<name",a.inArray("languages",i.plugins)!==-1&&a.each(i.languages,function(a,b){if(k.hasClass(b))return h+=' lang="'+c(b)+'"',o=b,!1}),f.length&&a.each(f,function(a,b){var d=k.attr(b);if(!i.xml_data.get_skip_empty||typeof d!="undefined")h+=" "+b+'="'+c((" "+d||"").replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+'"'}),k.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"").length&&(h+=' icon="'+c(k.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+'"'),k.children("ins").get(0).style.backgroundImage.length&&(h+=' icon="'+c(k.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")","").replace(/'/ig,"").replace(/"/ig,""))+'"'),h+=">",h+="<![CDATA["+j.get_text(k,o)+"]]>",h+="</name>"}),h+="</content>",l=m[0].id||!0,m=m.find("> ul > li"),m.length?l=j.get_xml(b,m,e,f,l):l="",b=="nest"&&(h+=l),h+="</item>",b=="flat"&&(h+=l)}),g||(h+="</root>"),h}}})}(jQuery),function(a){a().jquery.split(".")[1]>=8?(a.expr[":"].jstree_contains=a.expr.createPseudo(function(a){return function(b){return(b.textContent||b.innerText||"").toLowerCase().indexOf(a.toLowerCase())>=0}}),a.expr[":"].jstree_title_contains=a.expr.createPseudo(function(a){return function(b){return(b.getAttribute("title")||"").toLowerCase().indexOf(a.toLowerCase())>=0}})):(a.expr[":"].jstree_contains=function(a,b,c){return(a.textContent||a.innerText||"").toLowerCase().indexOf(c[3].toLowerCase())>=0},a.expr[":"].jstree_title_contains=function(a,b,c){return(a.getAttribute("title")||"").toLowerCase().indexOf(c[3].toLowerCase())>=0}),a.jstree.plugin("search",{__init:function(){this.data.search.str="",this.data.search.result=a(),this._get_settings().search.show_only_matches&&this.get_container().bind("search.jstree",function(b,c){a(this).children("ul").find("li").hide().removeClass("jstree-last"),d(c.rslt.nodes.parentsUntil(".jstree")).show().filter("ul").each(function(){a(this).children("li:visible").eq(-1).addClass("jstree-last")})}).bind("clear_search.jstree",function(){a(this).children("ul").find("li").css("display","").end().end().jstree("clean_node",-1)})},defaults:{ajax:!1,search_method:"jstree_contains",show_only_matches:!1},_fn:{search:function(b,c){if(a.trim(b)===""){this.clear_search();return}var d=this.get_settings().search,e=this,f=function(){},g=function(){};this.data.search.str=b;if(!c&&d.ajax!==!1&&this.get_container_ul().find("li.jstree-closed:not(:has(ul)):eq(0)").length>0){this.search.supress_callback=!0,f=function(){},g=function(a,b,c){var d=this.get_settings().search.ajax.success;d&&(a=d.call(this,a,b,c)||a),this.data.search.to_open=a,this._search_open()},d.ajax.context=this,d.ajax.error=f,d.ajax.success=g,a.isFunction(d.ajax.url)&&(d.ajax.url=d.ajax.url.call(this,b)),a.isFunction(d.ajax.data)&&(d.ajax.data=d.ajax.data.call(this,b)),d.ajax.data||(d.ajax.data={search_string:b});if(!d.ajax.dataType||/^json/.exec(d.ajax.dataType))d.ajax.dataType="json";a.ajax(d.ajax);return}this.data.search.result.length&&this.clear_search(),this.data.search.result=this.get_container().find("a"+(this.data.languages?"."+this.get_lang():"")+":"+d.search_method+"("+this.data.search.str+")"),this.data.search.result.addClass("jstree-search").parent().parents(".jstree-closed").each(function(){e.open_node(this,!1,!0)}),this.__callback({nodes:this.data.search.result,str:b})},clear_search:function(b){this.data.search.result.removeClass("jstree-search"),this.__callback(this.data.search.result),this.data.search.result=a()},_search_open:function(b){var c=this,d=!0,e=[],f=[];this.data.search.to_open.length&&(a.each(this.data.search.to_open,function(b,c){if(c=="#")return!0;a(c).length&&a(c).is(".jstree-closed")?e.push(c):f.push(c)}),e.length&&(this.data.search.to_open=f,a.each(e,function(a,b){c.open_node(b,function(){c._search_open(!0)})}),d=!1)),d&&this.search(this.data.search.str,!0)}}})}(jQuery),function(a){a.vakata.context={hide_on_mouseleave:!1,cnt:a("<div id='vakata-contextmenu' />"),vis:!1,tgt:!1,par:!1,func:!1,data:!1,rtl:!1,show:function(b,c,d,e,f,g,h){a.vakata.context.rtl=!!h;var i=a.vakata.context.parse(b),j,k;if(!i)return;a.vakata.context.vis=!0,a.vakata.context.tgt=c,a.vakata.context.par=g||c||null,a.vakata.context.data=f||null,a.vakata.context.cnt.html(i).css({visibility:"hidden",display:"block",left:0,top:0}),a.vakata.context.hide_on_mouseleave&&a.vakata.context.cnt.one("mouseleave",function(b){a.vakata.context.hide()}),j=a.vakata.context.cnt.height(),k=a.vakata.context.cnt.width(),d+k>a(document).width()&&(d=a(document).width()-(k+5),a.vakata.context.cnt.find("li > ul").addClass("right")),e+j>a(document).height()&&(e-=j+c[0].offsetHeight,a.vakata.context.cnt.find("li > ul").addClass("bottom")),a.vakata.context.cnt.css({left:d,top:e}).find("li:has(ul)").bind("mouseenter",function(b){var c=a(document).width(),d=a(document).height(),e=a(this).children("ul").show();c!==a(document).width()&&e.toggleClass("right"),d!==a(document).height()&&e.toggleClass("bottom")}).bind("mouseleave",function(b){a(this).children("ul").hide()}).end().css({visibility:"visible"}).show(),a(document).triggerHandler("context_show.vakata")},hide:function(){a.vakata.context.vis=!1,a.vakata.context.cnt.attr("class","").css({visibility:"hidden"}),a(document).triggerHandler("context_hide.vakata")},parse:function(b,c){if(!b)return!1;var d="",e=!1,f=!0;return c||(a.vakata.context.func={}),d+="<ul>",a.each(b,function(b,c){if(!c)return!0;a.vakata.context.func[b]=c.action,!f&&c.separator_before&&(d+="<li class='vakata-separator vakata-separator-before'></li>"),f=!1,d+="<li class='"+(c._class||"")+(c._disabled?" jstree-contextmenu-disabled ":"")+"'><ins ",c.icon&&c.icon.indexOf("/")===-1&&(d+=" class='"+c.icon+"' "),c.icon&&c.icon.indexOf("/")!==-1&&(d+=" style='background:url("+c.icon+") center center no-repeat;' "),d+=">&#160;</ins><a href='#' rel='"+b+"'>",c.submenu&&(d+="<span style='float:"+(a.vakata.context.rtl?"left":"right")+";'>&raquo;</span>"),d+=c.label+"</a>",c.submenu&&(e=a.vakata.context.parse(c.submenu,!0),e&&(d+=e)),d+="</li>",c.separator_after&&(d+="<li class='vakata-separator vakata-separator-after'></li>",f=!0)}),d=d.replace(/<li class\='vakata-separator vakata-separator-after'\><\/li\>$/,""),d+="</ul>",a(document).triggerHandler("context_parse.vakata"),d.length>10?d:!1},exec:function(b){return a.isFunction(a.vakata.context.func[b])?(a.vakata.context.func[b].call(a.vakata.context.data,a.vakata.context.par),!0):!1}},a(function(){var b="#vakata-contextmenu { display:block; visibility:hidden; left:0; top:-200px; position:absolute; margin:0; padding:0; min-width:180px; background:#ebebeb; border:1px solid silver; z-index:10000; *width:180px; } #vakata-contextmenu ul { min-width:180px; *width:180px; } #vakata-contextmenu ul, #vakata-contextmenu li { margin:0; padding:0; list-style-type:none; display:block; } #vakata-contextmenu li { line-height:20px; min-height:20px; position:relative; padding:0px; } #vakata-contextmenu li a { padding:1px 6px; line-height:17px; display:block; text-decoration:none; margin:1px 1px 0 1px; } #vakata-contextmenu li ins { float:left; width:16px; height:16px; text-decoration:none; margin-right:2px; } #vakata-contextmenu li a:hover, #vakata-contextmenu li.vakata-hover > a { background:gray; color:white; } #vakata-contextmenu li ul { display:none; position:absolute; top:-2px; left:100%; background:#ebebeb; border:1px solid gray; } #vakata-contextmenu .right { right:100%; left:auto; } #vakata-contextmenu .bottom { bottom:-1px; top:auto; } #vakata-contextmenu li.vakata-separator { min-height:0; height:1px; line-height:1px; font-size:1px; overflow:hidden; margin:0 2px; background:silver; /* border-top:1px solid #fefefe; */ padding:0; } ";a.vakata.css.add_sheet({str:b,title:"vakata"}),a.vakata.context.cnt.delegate("a","click",function(a){a.preventDefault()}).delegate("a","mouseup",function(b){!a(this).parent().hasClass("jstree-contextmenu-disabled")&&a.vakata.context.exec(a(this).attr("rel"))?a.vakata.context.hide():a(this).blur()}).delegate("a","mouseover",function(){a.vakata.context.cnt.find(".vakata-hover").removeClass("vakata-hover")}).appendTo("body"),a(document).bind("mousedown",function(b){a.vakata.context.vis&&!a.contains(a.vakata.context.cnt[0],b.target)&&a.vakata.context.hide()}),typeof a.hotkeys!="undefined"&&a(document).bind("keydown","up",function(b){if(a.vakata.context.vis){var c=a.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").prevAll("li:not(.vakata-separator)").first();c.length||(c=a.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").last()),c.addClass("vakata-hover"),b.stopImmediatePropagation(),b.preventDefault()}}).bind("keydown","down",function(b){if(a.vakata.context.vis){var c=a.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").nextAll("li:not(.vakata-separator)").first();c.length||(c=a.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").first()),c.addClass("vakata-hover"),b.stopImmediatePropagation(),b.preventDefault()}}).bind("keydown","right",function(b){a.vakata.context.vis&&(a.vakata.context.cnt.find(".vakata-hover").children("ul").show().children("li:not(.vakata-separator)").removeClass("vakata-hover").first().addClass("vakata-hover"),b.stopImmediatePropagation(),b.preventDefault())}).bind("keydown","left",function(b){a.vakata.context.vis&&(a.vakata.context.cnt.find(".vakata-hover").children("ul").hide().children(".vakata-separator").removeClass("vakata-hover"),b.stopImmediatePropagation(),b.preventDefault())}).bind("keydown","esc",function(b){a.vakata.context.hide(),b.preventDefault()}).bind("keydown","space",function(b){a.vakata.context.cnt.find(".vakata-hover").last().children("a").click(),b.preventDefault()})}),a.jstree.plugin("contextmenu",{__init:function(){this.get_container().delegate("a","contextmenu.jstree",a.proxy(function(b){b.preventDefault(),a(b.currentTarget).hasClass("jstree-loading")||this.show_contextmenu(b.currentTarget,b.pageX,b.pageY)},this)).delegate("a","click.jstree",a.proxy(function(b){this.data.contextmenu&&a.vakata.context.hide()},this)).bind("destroy.jstree",a.proxy(function(){this.data.contextmenu&&a.vakata.context.hide()},this)),a(document).bind("context_hide.vakata",a.proxy(function(){this.data.contextmenu=!1},this))},defaults:{select_node:!1,show_at_node:!0,items:{create:{separator_before:!1,separator_after:!0,label:"Create",action:function(a){this.create(a)}},rename:{separator_before:!1,separator_after:!1,label:"Rename",action:function(a){this.rename(a)}},remove:{separator_before:!1,icon:!1,separator_after:!1,label:"Delete",action:function(a){this.is_selected(a)?this.remove():this.remove(a)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:"Cut",action:function(a){this.cut(a)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(a){this.copy(a)}},paste:{separator_before:!1,icon:!1,separator_after:!1,label:"Paste",action:function(a){this.paste(a)}}}}}},_fn:{show_contextmenu:function(b,c,d){b=this._get_node(b);var e=this.get_settings().contextmenu,f=b.children("a:visible:eq(0)"),g=!1,h=!1;e.select_node&&this.data.ui&&!this.is_selected(b)&&(this.deselect_all(),this.select_node(b,!0));if(e.show_at_node||typeof c=="undefined"||typeof d=="undefined")g=f.offset(),c=g.left,d=g.top+this.data.core.li_height;h=b.data("jstree")&&b.data("jstree").contextmenu?b.data("jstree").contextmenu:e.items,a.isFunction(h)&&(h=h.call(this,b)),this.data.contextmenu=!0,a.vakata.context.show(h,f,c,d,this,b,this._get_settings().core.rtl),this.data.themes&&a.vakata.context.cnt.attr("class","jstree-"+this.data.themes.theme+"-context")}}})}(jQuery),function(b){b.jstree.plugin("types",{__init:function(){var c=this._get_settings().types;this.data.types.attach_to=[],this.get_container().bind("init.jstree",b.proxy(function(){var a=c.types,d=c.type_attr,e="",f=this;b.each(a,function(a,c){b.each(c,function(a,b){/^(max_depth|max_children|icon|valid_children)$/.test(a)||f.data.types.attach_to.push(a)});if(!c.icon)return!0;if(c.icon.image||c.icon.position)a=="default"?e+=".jstree-"+f.get_index()+" a > .jstree-icon { ":e+=".jstree-"+f.get_index()+" li["+d+'="'+a+'"] > a > .jstree-icon { ',c.icon.image&&(e+=" background-image:url("+c.icon.image+"); "),c.icon.position?e+=" background-position:"+c.icon.position+"; ":e+=" background-position:0 0; ",e+="} "}),e!==""&&b.vakata.css.add_sheet({str:e,title:"jstree-types"})},this)).bind("before.jstree",b.proxy(function(a,c){var d,e,f=this._get_settings().types.use_data?this._get_node(c.args[0]):!1,g=f&&f!==-1&&f.length?f.data("jstree"):!1;if(g&&g.types&&g.types[c.func]===!1)return a.stopImmediatePropagation(),!1;if(b.inArray(c.func,this.data.types.attach_to)!==-1){if(!c.args[0]||!c.args[0].tagName&&!c.args[0].jquery)return;d=this._get_settings().types.types,e=this._get_type(c.args[0]);if((d[e]&&typeof d[e][c.func]!="undefined"||d["default"]&&typeof d["default"][c.func]!="undefined")&&this._check(c.func,c.args[0])===!1)return a.stopImmediatePropagation(),!1}},this)),a&&this.get_container().bind("load_node.jstree set_type.jstree",b.proxy(function(a,c){var d=c&&c.rslt&&c.rslt.obj&&c.rslt.obj!==-1?this._get_node(c.rslt.obj).parent():this.get_container_ul(),e=!1,f=this._get_settings().types;b.each(f.types,function(a,b){b.icon&&(b.icon.image||b.icon.position)&&(e=a==="default"?d.find("li > a > .jstree-icon"):d.find("li["+f.type_attr+"='"+a+"'] > a > .jstree-icon"),b.icon.image&&e.css("backgroundImage","url("+b.icon.image+")"),e.css("backgroundPosition",b.icon.position||"0 0"))})},this))},defaults:{max_children:-1,max_depth:-1,valid_children:"all",use_data:!1,type_attr:"rel",types:{"default":{max_children:-1,max_depth:-1,valid_children:"all"}}},_fn:{_types_notify:function(a,b){b.type&&this._get_settings().types.use_data&&this.set_type(b.type,a)},_get_type:function(a){return a=this._get_node(a),!a||!a.length?!1:a.attr(this._get_settings().types.type_attr)||"default"},set_type:function(a,b){b=this._get_node(b);var c=!b.length||!a?!1:b.attr(this._get_settings().types.type_attr,a);return c&&this.__callback({obj:b,type:a}),c},_check:function(a,c,d){c=this._get_node(c);var e=!1,f=this._get_type(c),g=0,h=this,i=this._get_settings().types,j=!1;if(c===-1){if(!i[a])return;e=i[a]}else{if(f===!1)return;j=i.use_data?c.data("jstree"):!1,j&&j.types&&typeof j.types[a]!="undefined"?e=j.types[a]:!i.types[f]||typeof i.types[f][a]=="undefined"?!!i.types["default"]&&typeof i.types["default"][a]!="undefined"&&(e=i.types["default"][a]):e=i.types[f][a]}return b.isFunction(e)&&(e=e.call(this,c)),a==="max_depth"&&c!==-1&&d!==!1&&i.max_depth!==-2&&e!==0&&c.children("a:eq(0)").parentsUntil(".jstree","li").each(function(b){if(i.max_depth!==-1&&i.max_depth-(b+1)<=0)return e=0,!1;g=b===0?e:h._check(a,this,!1);if(g!==-1&&g-(b+1)<=0)return e=0,!1;g>=0&&(g-(b+1)<e||e<0)&&(e=g-(b+1)),i.max_depth>=0&&(i.max_depth-(b+1)<e||e<0)&&(e=i.max_depth-(b+1))}),e},check_move:function(){if(!this.__call_old())return!1;var a=this._get_move(),c=a.rt._get_settings().types,d=a.rt._check("max_children",a.cr),e=a.rt._check("max_depth",a.cr),f=a.rt._check("valid_children",a.cr),g=0,h=1,i;if(f==="none")return!1;if(b.isArray(f)&&a.ot&&a.ot._get_type){a.o.each(function(){if(b.inArray(a.ot._get_type(this),f)===-1)return h=!1,!1});if(h===!1)return!1}if(c.max_children!==-2&&d!==-1){g=a.cr===-1?this.get_container().find("> ul > li").not(a.o).length:a.cr.find("> ul > li").not(a.o).length;if(g+a.o.length>d)return!1}if(c.max_depth!==-2&&e!==-1){h=0;if(e===0)return!1;if(typeof a.o.d=="undefined"){i=a.o;while(i.length>0)i=i.find("> ul > li"),h++;a.o.d=h}if(e-a.o.d<0)return!1}return!0},create_node:function(a,c,d,e,f,g){if(!g&&(f||this._is_loaded(a))){var h=typeof c=="string"&&c.match(/^before|after$/i)&&a!==-1?this._get_parent(a):this._get_node(a),i=this._get_settings().types,j=this._check("max_children",h),k=this._check("max_depth",h),l=this._check("valid_children",h),m;typeof d=="string"&&(d={data:d}),d||(d={});if(l==="none")return!1;if(b.isArray(l))if(!d.attr||!d.attr[i.type_attr])d.attr||(d.attr={}),d.attr[i.type_attr]=l[0];else if(b.inArray(d.attr[i.type_attr],l)===-1)return!1;if(i.max_children!==-2&&j!==-1){m=h===-1?this.get_container().find("> ul > li").length:h.find("> ul > li").length;if(m+1>j)return!1}if(i.max_depth!==-2&&k!==-1&&k-1<0)return!1}return this.__call_old(!0,a,c,d,e,f,g)}}})}(jQuery),function(a){a.jstree.plugin("html_data",{__init:function(){this.data.html_data.original_container_html=this.get_container().find(" > ul > li").clone(!0),d(this.data.html_data.original_container_html.find("li")).contents().filter(function(){return this.nodeType==3}).remove()},defaults:{data:!1,ajax:!1,correct_state:!0},_fn:{load_node:function(a,b,c){var d=this;this.load_node_html(a,function(){d.__callback({obj:d._get_node(a)}),b.call(this)},c)},_is_loaded:function(b){return b=this._get_node(b),b==-1||!b||!this._get_settings().html_data.ajax&&!a.isFunction(this._get_settings().html_data.data)||b.is(".jstree-open, .jstree-leaf")||b.children("ul").children("li").size()>0},load_node_html:function(b,c,d){var e,f=this.get_settings().html_data,g=function(){},h=function(){};b=this._get_node(b);if(b&&b!==-1){if(b.data("jstree_is_loading"))return;b.data("jstree_is_loading",!0)}switch(!0){case a.isFunction(f.data):f.data.call(this,b,a.proxy(function(d){d&&d!==""&&d.toString&&d.toString().replace(/^[\s\n]+$/,"")!==""?(d=a(d),d.is("ul")||(d=a("<ul />").append(d)),b==-1||!b?this.get_container().children("ul").empty().append(d.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"):(b.children("a.jstree-loading").removeClass("jstree-loading"),b.append(d).children("ul").find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),b.removeData("jstree_is_loading")),this.clean_node(b),c&&c.call(this)):b&&b!==-1?(b.children("a.jstree-loading").removeClass("jstree-loading"),b.removeData("jstree_is_loading"),f.correct_state&&(this.correct_state(b),c&&c.call(this))):f.correct_state&&(this.get_container().children("ul").empty(),c&&c.call(this))},this));break;case!f.data&&!f.ajax:if(!b||b==-1)this.get_container().children("ul").empty().append(this.data.html_data.original_container_html).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),this.clean_node();c&&c.call(this);break;case!!f.data&&!f.ajax||!!f.data&&!!f.ajax&&(!b||b===-1):if(!b||b==-1)e=a(f.data),e.is("ul")||(e=a("<ul />").append(e)),this.get_container().children("ul").empty().append(e.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),this.clean_node();c&&c.call(this);break;case!f.data&&!!f.ajax||!!f.data&&!!f.ajax&&b&&b!==-1:b=this._get_node(b),g=function(a,c,e){var g=this.get_settings().html_data.ajax.error;g&&g.call(this,a,c,e),b!=-1&&b.length?(b.children("a.jstree-loading").removeClass("jstree-loading"),b.removeData("jstree_is_loading"),c==="success"&&f.correct_state&&this.correct_state(b)):c==="success"&&f.correct_state&&this.get_container().children("ul").empty(),d&&d.call(this)},h=function(d,e,h){var i=this.get_settings().html_data.ajax.success;i&&(d=i.call(this,d,e,h)||d);if(d===""||d&&d.toString&&d.toString().replace(/^[\s\n]+$/,"")==="")return g.call(this,h,e,"");d?(d=a(d),d.is("ul")||(d=a("<ul />").append(d)),b==-1||!b?this.get_container().children("ul").empty().append(d.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"):(b.children("a.jstree-loading").removeClass("jstree-loading"),b.append(d).children("ul").find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),b.removeData("jstree_is_loading")),this.clean_node(b),c&&c.call(this)):b&&b!==-1?(b.children("a.jstree-loading").removeClass("jstree-loading"),b.removeData("jstree_is_loading"),f.correct_state&&(this.correct_state(b),c&&c.call(this))):f.correct_state&&(this.get_container().children("ul").empty(),c&&c.call(this))},f.ajax.context=this,f.ajax.error=g,f.ajax.success=h,f.ajax.dataType||(f.ajax.dataType="html"),a.isFunction(f.ajax.url)&&(f.ajax.url=f.ajax.url.call(this,b)),a.isFunction(f.ajax.data)&&(f.ajax.data=f.ajax.data.call(this,b)),a.ajax(f.ajax)}}}}),a.jstree.defaults.plugins.push("html_data")}(jQuery),function(a){a.jstree.plugin("themeroller",{__init:function(){var b=this._get_settings().themeroller;this.get_container().addClass("ui-widget-content").addClass("jstree-themeroller").delegate("a","mouseenter.jstree",function(c){a(c.currentTarget).hasClass("jstree-loading")||a(this).addClass(b.item_h)}).delegate("a","mouseleave.jstree",function(){a(this).removeClass(b.item_h)}).bind("init.jstree",a.proxy(function(a,b){b.inst.get_container().find("> ul > li > .jstree-loading > ins").addClass("ui-icon-refresh"),this._themeroller(b.inst.get_container().find("> ul > li"))},this)).bind("open_node.jstree create_node.jstree",a.proxy(function(a,b){this._themeroller(b.rslt.obj)},this)).bind("loaded.jstree refresh.jstree",a.proxy(function(a){this._themeroller()},this)).bind("close_node.jstree",a.proxy(function(a,b){this._themeroller(b.rslt.obj)},this)).bind("delete_node.jstree",a.proxy(function(a,b){this._themeroller(b.rslt.parent)},this)).bind("correct_state.jstree",a.proxy(function(a,c){c.rslt.obj.children("ins.jstree-icon").removeClass(b.opened+" "+b.closed+" ui-icon").end().find("> a > ins.ui-icon").filter(function(){return this.className.toString().replace(b.item_clsd,"").replace(b.item_open,"").replace(b.item_leaf,"").indexOf("ui-icon-")===-1}).removeClass(b.item_open+" "+b.item_clsd).addClass(b.item_leaf||"jstree-no-icon")},this)).bind("select_node.jstree",a.proxy(function(a,c){c.rslt.obj.children("a").addClass(b.item_a)},this)).bind("deselect_node.jstree deselect_all.jstree",a.proxy(function(a,c){this.get_container().find("a."+b.item_a).removeClass(b.item_a).end().find("a.jstree-clicked").addClass(b.item_a)},this)).bind("dehover_node.jstree",a.proxy(function(a,c){c.rslt.obj.children("a").removeClass(b.item_h)},this)).bind("hover_node.jstree",a.proxy(function(a,c){this.get_container().find("a."+b.item_h).not(c.rslt.obj).removeClass(b.item_h),c.rslt.obj.children("a").addClass(b.item_h)},this)).bind("move_node.jstree",a.proxy(function(a,b){this._themeroller(b.rslt.o),this._themeroller(b.rslt.op)},this))},__destroy:function(){var b=this._get_settings().themeroller,c=["ui-icon"];a.each(b,function(a,b){b=b.split(" "),b.length&&(c=c.concat(b))}),this.get_container().removeClass("ui-widget-content").find("."+c.join(", .")).removeClass(c.join(" "))},_fn:{_themeroller:function(a){var b=this._get_settings().themeroller;a=!a||a==-1?this.get_container_ul():this._get_node(a),a=!a||a==-1?this.get_container_ul():a.parent(),a.find("li.jstree-closed").children("ins.jstree-icon").removeClass(b.opened).addClass("ui-icon "+b.closed).end().children("a").addClass(b.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return this.className.toString().replace(b.item_clsd,"").replace(b.item_open,"").replace(b.item_leaf,"").indexOf("ui-icon-")===-1}).removeClass(b.item_leaf+" "+b.item_open).addClass(b.item_clsd||"jstree-no-icon").end().end().end().end().find("li.jstree-open").children("ins.jstree-icon").removeClass(b.closed).addClass("ui-icon "+b.opened).end().children("a").addClass(b.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return this.className.toString().replace(b.item_clsd,"").replace(b.item_open,"").replace(b.item_leaf,"").indexOf("ui-icon-")===-1}).removeClass(b.item_leaf+" "+b.item_clsd).addClass(b.item_open||"jstree-no-icon").end().end().end().end().find("li.jstree-leaf").children("ins.jstree-icon").removeClass(b.closed+" ui-icon "+b.opened).end().children("a").addClass(b.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return this.className.toString().replace(b.item_clsd,"").replace(b.item_open,"").replace(b.item_leaf,"").indexOf("ui-icon-")===-1}).removeClass(b.item_clsd+" "+b.item_open).addClass(b.item_leaf||"jstree-no-icon")}},defaults:{opened:"ui-icon-triangle-1-se",closed:"ui-icon-triangle-1-e",item:"ui-state-default",item_h:"ui-state-hover",item_a:"ui-state-active",item_open:"ui-icon-folder-open",item_clsd:"ui-icon-folder-collapsed",item_leaf:"ui-icon-document"}}),a(function(){var b=".jstree-themeroller .ui-icon { overflow:visible; } .jstree-themeroller a { padding:0 2px; } .jstree-themeroller .jstree-no-icon { display:none; }";a.vakata.css.add_sheet({str:b,title:"jstree"})})}(jQuery),function(a){a.jstree.plugin("unique",{__init:function(){this.get_container().bind("before.jstree",a.proxy(function(b,c){var d=[],e=!0,f,g;c.func=="move_node"&&c.args[4]===!0&&c.args[0].o&&c.args[0].o.length&&(c.args[0].o.children("a").each(function(){d.push(a(this).text().replace(/^\s+/g,""))}),e=this._check_unique(d,c.args[0].np.find("> ul > li").not(c.args[0].o),"move_node"));if(c.func=="create_node")if(c.args[4]||this._is_loaded(c.args[0])){f=this._get_node(c.args[0]);if(c.args[1]&&(c.args[1]==="before"||c.args[1]==="after")){f=this._get_parent(c.args[0]);if(!f||f===-1)f=this.get_container()}typeof c.args[2]=="string"?d.push(c.args[2]):!c.args[2]||!c.args[2].data?d.push(this._get_string("new_node")):d.push(c.args[2].data),e=this._check_unique(d,f.find("> ul > li"),"create_node")}if(c.func=="rename_node"){d.push(c.args[1]),g=this._get_node(c.args[0]),f=this._get_parent(g);if(!f||f===-1)f=this.get_container();e=this._check_unique(d,f.find("> ul > li").not(g),"rename_node")}if(!e)return b.stopPropagation(),!1},this))},defaults:{error_callback:a.noop},_fn:{_check_unique:function(b,c,d){var e=[],f=!0;return c.children("a").each(function(){e.push(a(this).text().replace(/^\s+/g,""))}),!e.length||!b.length?!0:(a.each(b,function(b,c){if(a.inArray(c,e)!==-1)return f=!1,!1}),f||this._get_settings().unique.error_callback.call(null,b,c,d),f)},check_move:function(){if(!this.__call_old())return!1;var b=this._get_move(),c=[];return b.o&&b.o.length?(b.o.children("a").each(function(){c.push(a(this).text().replace(/^\s+/g,""))}),this._check_unique(c,b.np.find("> ul > li").not(b.o),"check_move")):!0}}})}(jQuery),function(e){e.jstree.plugin("wholerow",{__init:function(){if(!this.data.ui)throw"jsTree wholerow: jsTree UI plugin not included.";this.data.wholerow.html=!1,this.data.wholerow.to=!1,this.get_container().bind("init.jstree",e.proxy(function(a,b){this._get_settings().core.animation=0},this)).bind("open_node.jstree create_node.jstree clean_node.jstree loaded.jstree",e.proxy(function(a,b){this._prepare_wholerow_span(b&&b.rslt&&b.rslt.obj?b.rslt.obj:-1)},this)).bind("search.jstree clear_search.jstree reopen.jstree after_open.jstree after_close.jstree create_node.jstree delete_node.jstree clean_node.jstree",e.proxy(function(a,b){this.data.to&&clearTimeout(this.data.to),this.data.to=setTimeout(function(a,b){return function(){a._prepare_wholerow_ul(b)}}(this,b&&b.rslt&&b.rslt.obj?b.rslt.obj:-1),0)},this)).bind("deselect_all.jstree",e.proxy(function(a,b){this.get_container().find(" > .jstree-wholerow .jstree-clicked").removeClass("jstree-clicked "+(this.data.themeroller?this._get_settings().themeroller.item_a:""))},this)).bind("select_node.jstree deselect_node.jstree ",e.proxy(function(a,b){b.rslt.obj.each(function(){var a=b.inst.get_container().find(" > .jstree-wholerow li:visible:eq("+parseInt((e(this).offset().top-b.inst.get_container().offset().top+b.inst.get_container()[0].scrollTop)/b.inst.data.core.li_height,10)+")");a.children("a").attr("class",b.rslt.obj.children("a").attr("class"))})},this)).bind("hover_node.jstree dehover_node.jstree",e.proxy(function(a,b){this.get_container().find(" > .jstree-wholerow .jstree-hovered").removeClass("jstree-hovered "+(this.data.themeroller?this._get_settings().themeroller.item_h:""));if(a.type==="hover_node"){var c=this.get_container().find(" > .jstree-wholerow li:visible:eq("+parseInt((b.rslt.obj.offset().top-this.get_container().offset().top+this.get_container()[0].scrollTop)/this.data.core.li_height,10)+")");c.children("a").attr("class",b.rslt.obj.children(".jstree-hovered").attr("class"))}},this)).delegate(".jstree-wholerow-span, ins.jstree-icon, li","click.jstree",function(a){var b=e(a.currentTarget);if(a.target.tagName==="A"||a.target.tagName==="INS"&&b.closest("li").is(".jstree-open, .jstree-closed"))return;b.closest("li").children("a:visible:eq(0)").click(),a.stopImmediatePropagation()}).delegate("li","mouseover.jstree",e.proxy(function(a){return a.stopImmediatePropagation(),e(a.currentTarget).children(".jstree-hovered, .jstree-clicked").length?!1:(this.hover_node(a.currentTarget),!1)},this)).delegate("li","mouseleave.jstree",e.proxy(function(a){if(e(a.currentTarget).children("a").hasClass("jstree-hovered").length)return;this.dehover_node(a.currentTarget)},this)),(b||a)&&e.vakata.css.add_sheet({str:".jstree-"+this.get_index()+" { position:relative; } ",title:"jstree"})},defaults:{},__destroy:function(){this.get_container().children(".jstree-wholerow").remove(),this.get_container().find(".jstree-wholerow-span").remove()},_fn:{_prepare_wholerow_span:function(a){a=!a||a==-1?this.get_container().find("> ul > li"):this._get_node(a);if(a===!1)return;a.each(function(){d(e(this).find("li")).each(function(){var a=e(this);if(a.children(".jstree-wholerow-span").length)return!0;a.prepend("<span class='jstree-wholerow-span' style='width:"+a.parentsUntil(".jstree","li").length*18+"px;'>&#160;</span>")})})},_prepare_wholerow_ul:function(){var a=this.get_container().children("ul").eq(0),c=a.html();a.addClass("jstree-wholerow-real"),this.data.wholerow.last_html!==c&&(this.data.wholerow.last_html=c,this.get_container().children(".jstree-wholerow").remove(),this.get_container().append(a.clone().removeClass("jstree-wholerow-real").wrapAll("<div class='jstree-wholerow' />").parent().width(a.parent()[0].scrollWidth).css("top",(a.height()+(b?5:0))*-1).find("li[id]").each(function(){this.removeAttribute("id")}).end()))}}}),e(function(){var d=".jstree .jstree-wholerow-real { position:relative; z-index:1; } .jstree .jstree-wholerow-real li { cursor:pointer; } .jstree .jstree-wholerow-real a { border-left-color:transparent !important; border-right-color:transparent !important; } .jstree .jstree-wholerow { position:relative; z-index:0; height:0; } .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { width:100%; } .jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li, .jstree .jstree-wholerow a { margin:0 !important; padding:0 !important; } .jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { background:transparent !important; }.jstree .jstree-wholerow ins, .jstree .jstree-wholerow span, .jstree .jstree-wholerow input { display:none !important; }.jstree .jstree-wholerow a, .jstree .jstree-wholerow a:hover { text-indent:-9999px; !important; width:100%; padding:0 !important; border-right-width:0px !important; border-left-width:0px !important; } .jstree .jstree-wholerow-span { position:absolute; left:0; margin:0px; padding:0; height:18px; border-width:0; padding:0; z-index:0; }";c&&(d+=".jstree .jstree-wholerow a { display:block; height:18px; margin:0; padding:0; border:0; } .jstree .jstree-wholerow-real a { border-color:transparent !important; } ");if(b||a)d+=".jstree .jstree-wholerow, .jstree .jstree-wholerow li, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow a { margin:0; padding:0; line-height:18px; } .jstree .jstree-wholerow a { display:block; height:18px; line-height:18px; overflow:hidden; } ";e.vakata.css.add_sheet({str:d,title:"jstree"})})}(jQuery),function(a){var b=["getChildren","getChildrenCount","getAttr","getName","getProps"],c=function(b,c){var d=!0;return b=b||{},c=[].concat(c),a.each(c,function(c,e){if(!a.isFunction(b[e]))return d=!1,!1}),d};a.jstree.plugin("model",{__init:function(){if(!this.data.json_data)throw"jsTree model: jsTree json_data plugin not included.";this._get_settings().json_data.data=function(d,e){var f=d==-1?this._get_settings().model.object:d.data("jstree_model");if(!c(f,b))return e.call(null,!1);this._get_settings().model.async?f.getChildren(a.proxy(function(a){this.model_done(a,e)},this)):this.model_done(f.getChildren(),e)}},defaults:{object:!1,id_prefix:!1,async:!1},_fn:{model_done:function(b,c){var d=[],e=this._get_settings(),f=this;a.isArray(b)||(b=[b]),a.each(b,function(b,c){var g=c.getProps()||{};g.attr=c.getAttr()||{},c.getChildrenCount()&&(g.state="closed"),g.data=c.getName(),a.isArray(g.data)||(g.data=[g.data]),f.data.types&&a.isFunction(c.getType)&&(g.attr[e.types.type_attr]=c.getType()),g.attr.id&&e.model.id_prefix&&(g.attr.id=e.model.id_prefix+g.attr.id),g.metadata||(g.metadata={}),g.metadata.jstree_model=c,d.push(g)}),c.call(null,d)}}})}(jQuery)}()